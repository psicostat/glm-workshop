<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea1d7ac60288e0f1efdbc993fd8432ae.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/academicons-1.9.4/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/academicons-1.9.4/size.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.21">

  <meta name="author" content="Margherita Calderan">
  <meta name="author" content="Filippo Gambarota">
  <title>GLM Workshop – Binomial GLM example</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-38aae41c7f244e387608eb2b1713ee2f.css">

<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Binomial GLM example</h1>
  <p class="subtitle">Generalized Linear Models Workshop</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://mar-cald.github.io">Margherita Calderan</a> <a href="https://orcid.org/0009-0005-5668-5162" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:margherita.calderan@unipd.it">margherita.calderan@unipd.it</a>
</div>
        <p class="quarto-title-affiliation">
            University of Padova
          </p>
    </div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://filippogambarota.github.io">Filippo Gambarota</a> <a href="https://orcid.org/0000-0002-6666-1747" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:filippo.gambarota@unipd.it">filippo.gambarota@unipd.it</a>
</div>
        <p class="quarto-title-affiliation">
            University of Padova
          </p>
    </div>
</div>

  <p class="date"><em>Last modified: 21-01-2026</em></p>
</section>
<section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Contents</h2>
<ul>
<li><a href="#/a-dataset-example" id="/toc-a-dataset-example">A dataset example</a></li>
<li><a href="#/model" id="/toc-model">Model</a></li>
<li><a href="#/diagnostics" id="/toc-diagnostics">Diagnostics</a></li>
<li><a href="#/monte-carlo-simulations-mcs" id="/toc-monte-carlo-simulations-mcs">Monte Carlo simulations (MCS)</a></li>
<li><a href="#/latent-formulation-of-the-binomial-model" id="/toc-latent-formulation-of-the-binomial-model">Latent formulation of the binomial model</a></li>
<li><a href="#/probit-link-function" id="/toc-probit-link-function">Probit link function</a></li>
<li><a href="#/odds-ratio-or-to-cohens-d" id="/toc-odds-ratio-or-to-cohens-d">Odds Ratio (OR) to Cohen’s <span class="math inline">\(d\)</span></a></li>
<li><a href="#/binary-vs-binomial-data-structure" id="/toc-binary-vs-binomial-data-structure">Binary vs binomial data structure</a></li>
</ul>
</nav>
</section>

<section>
<section id="a-dataset-example" class="title-slide slide level1 center">
<h1>A dataset example</h1>

</section>
<section id="example-shimizu2024-xl" class="slide level2">
<h2>Example: <span class="citation" data-cites="Shimizu2024-xl">Shimizu et al. (<a href="#/references" role="doc-biblioref" onclick="">2024</a>)</span></h2>
<style>
    .hg {
        background-color: yellow;
    }
</style>
<p><span class="citation" data-cites="Shimizu2024-xl">Shimizu et al. (<a href="#/references" role="doc-biblioref" onclick="">2024</a>)</span> investigated the processing of emotional faces.</p>
<ul>
<li>6 basic emotions: anger, disgust, fear, happiness, sadness and surprise</li>
<li>intensity in % (from 10% to 100% in steps of 10%)</li>
<li>71 participants</li>
<li>377 faces (males and females of different identities)</li>
<li>forced-choice procedure with 7 options (6 emotions + neutral). Chance level at <span class="math inline">\(1/7 = 0.14\)</span>.</li>
</ul>
</section>
<section id="shimizu2024-xl-dataset" class="slide level2">
<h2><span class="citation" data-cites="Shimizu2024-xl">Shimizu et al. (<a href="#/references" role="doc-biblioref" onclick="">2024</a>)</span> dataset</h2>
<p>We did some pre-processing for the purpose of this example. The original dataset can be found at <i class="ai  ai-osf" aria-label="osf"></i> <a href="https://osf.io/zhtbj/">osf.io/zhtbj/</a>.</p>
<p>You can download the dataset for this example at this <a href="../data/shimizu2024.rds">link</a>. It is a <code>rds</code> file, and you can open it using:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"shimizu.rds"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Then we can load some packages:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)      <span class="co"># for mixed-models</span></span>
<span id="cb2-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># for data manipulation</span></span>
<span id="cb2-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)   <span class="co"># plotting</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="exploring" class="slide level2">
<h2>Exploring</h2>
<p>For the purpose if this workshop, we will focus on a single subject (otherwise we should use a mixed-effects model). We also select only the relevant columns.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">subset</span>(dat, id <span class="sc">==</span> <span class="dv">22</span>)</span>
<span id="cb3-2"><a aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[, <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"age"</span>, <span class="st">"intensity"</span>, <span class="st">"emotion_lbl"</span>, <span class="st">"response_lbl"</span>, <span class="st">"acc"</span>)]</span>
<span id="cb3-3"><a aria-hidden="true" tabindex="-1"></a>dat</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 377 × 6
      id age   intensity emotion_lbl response_lbl   acc
   &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;        &lt;int&gt;
 1    22 53           60 fear        suprise          0
 2    22 53           60 disgust     disgust          1
 3    22 53           70 happiness   happiness        1
 4    22 53          100 happiness   happiness        1
 5    22 53           60 disgust     sadness          0
 6    22 53           20 fear        neutral          0
 7    22 53           10 fear        neutral          0
 8    22 53          100 sadness     sadness          1
 9    22 53           90 disgust     disgust          1
10    22 53           40 happiness   happiness        1
# ℹ 367 more rows</code></pre>
</div>
</div>
</section>
<section id="exploring-1" class="slide level2">
<h2>Exploring</h2>
<ul>
<li>We have 377 trials and 6 columns.</li>
<li>The <code>intensity</code> is the intensity (from 10% to 100%) of the facial expression. <code>emotion_lbl</code> is the emotion and <code>response_lbl</code> is the response.</li>
<li>When <code>emotion_lbl = response_lbl</code> the <code>acc = 1</code> namely a correct response.</li>
</ul>
</section>
<section id="exploring-2" class="slide level2">
<h2>Exploring</h2>
<p>We can calculate the average accuracy for each emotion. Clearly there is a big difference with <code>fear</code> being the hardest one and <code>surprise</code> the easiest. We remove <code>neutral</code> because we have no associated intensity</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(emotion_lbl) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p =</span> <span class="fu">mean</span>(acc),</span>
<span id="cb5-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(p))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  emotion_lbl     p     n
  &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
1 neutral     1         7
2 surprise    0.8      70
3 happiness   0.686    70
4 sadness     0.517    60
5 disgust     0.35    100
6 anger       0.333    30
7 fear        0.05     40</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">filter</span>(dat, emotion_lbl <span class="sc">!=</span> <span class="st">"neutral"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="exploring-3" class="slide level2">
<h2>Exploring</h2>
<p>Also for intensity, there is a clear increasing pattern. In this specific subject, the highest intensities are not clearly distinguished (maybe a non-linear pattern).</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(intensity) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p =</span> <span class="fu">mean</span>(acc),</span>
<span id="cb8-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(p))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   intensity      p     n
       &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
 1        70 0.703     37
 2        90 0.676     37
 3       100 0.676     37
 4        80 0.649     37
 5        50 0.622     37
 6        60 0.622     37
 7        40 0.486     37
 8        30 0.324     37
 9        10 0.0811    37
10        20 0.0811    37</code></pre>
</div>
</div>
</section>
<section id="exploring-plots" class="slide level2">
<h2>Exploring, plots</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(emotion_lbl) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p =</span> <span class="fu">mean</span>(acc),</span>
<span id="cb10-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(emotion_lbl, p), <span class="at">y =</span> p)) <span class="sc">+</span> </span>
<span id="cb10-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">group =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb10-9"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Emotion"</span>) <span class="sc">+</span></span>
<span id="cb10-10"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Accuracy"</span>) <span class="sc">+</span></span>
<span id="cb10-11"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">7</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

</section>
<section id="exploring-plots-output" class="slide level2 output-location-slide"><h2>Exploring, plots</h2><div class="cell output-location-slide" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-7-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div></section><section id="exploring-plots-1" class="slide level2">
<h2>Exploring, plots</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(intensity) <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p =</span> <span class="fu">mean</span>(acc),</span>
<span id="cb11-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb11-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(p)) <span class="sc">|&gt;</span> </span>
<span id="cb11-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> intensity, <span class="at">y =</span> p)) <span class="sc">+</span> </span>
<span id="cb11-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb11-8"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-9"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb11-10"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Intensity (%)"</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Accuracy"</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">7</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

</section>
<section id="exploring-plots-1-output" class="slide level2 output-location-slide"><h2>Exploring, plots</h2><div class="cell output-location-slide" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-8-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div></section><section id="exploring-plots-2" class="slide level2">
<h2>Exploring, plots</h2>
<p>We have few trials but we can also explore the interaction between emotion and intensity. There are some emotions where the rate of increase in accuracy as a function of the emotion is faster compared to others.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(intensity, emotion_lbl) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p =</span> <span class="fu">mean</span>(acc)) <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> intensity, <span class="at">y =</span> p, <span class="at">color =</span> emotion_lbl)) <span class="sc">+</span></span>
<span id="cb12-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

</section>
<section id="exploring-plots-2-output" class="slide level2 output-location-slide"><h2>Exploring, plots</h2><div class="cell output-location-slide" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-9-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div></section><section id="exploring-odds-and-odds-ratios" class="slide level2">
<h2>Exploring, odds and odds ratios</h2>
<p>We can start exploring the effects calculating odds and odds ratios.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a>odds <span class="ot">&lt;-</span> <span class="cf">function</span>(p) p <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> p)</span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a>or <span class="ot">&lt;-</span> <span class="cf">function</span>(pn, pd) <span class="fu">odds</span>(pn) <span class="sc">/</span> <span class="fu">odds</span>(pd)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a>(p_anger <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>acc[dat<span class="sc">$</span>emotion_lbl <span class="sc">==</span> <span class="st">"anger"</span>]))</span>
<span id="cb14-2"><a aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3333333</span></span>
<span id="cb14-3"><a aria-hidden="true" tabindex="-1"></a>(p_surprise <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>acc[dat<span class="sc">$</span>emotion_lbl <span class="sc">==</span> <span class="st">"surprise"</span>]))</span>
<span id="cb14-4"><a aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8</span></span>
<span id="cb14-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a aria-hidden="true" tabindex="-1"></a><span class="fu">odds</span>(p_anger)</span>
<span id="cb14-7"><a aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.5</span></span>
<span id="cb14-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">odds</span>(p_surprise)</span>
<span id="cb14-9"><a aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4</span></span>
<span id="cb14-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a aria-hidden="true" tabindex="-1"></a><span class="fu">or</span>(p_surprise, p_anger)</span>
<span id="cb14-12"><a aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 8</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="exploring-odds-and-odds-ratios-1" class="slide level2">
<h2>Exploring, odds and odds ratios</h2>
<p>We can also create a contingency table:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>acc, dat<span class="sc">$</span>emotion_lbl)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    anger disgust fear happiness sadness surprise
  0    20      65   38        22      29       14
  1    10      35    2        48      31       56</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a>(all_p <span class="ot">&lt;-</span> <span class="fu">tapply</span>(dat<span class="sc">$</span>acc, dat<span class="sc">$</span>emotion_lbl, <span class="at">FUN =</span> mean))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    anger   disgust      fear happiness   sadness  surprise 
0.3333333 0.3500000 0.0500000 0.6857143 0.5166667 0.8000000 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">odds</span>(all_p)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     anger    disgust       fear  happiness    sadness   surprise 
0.50000000 0.53846154 0.05263158 2.18181818 1.06896552 4.00000000 </code></pre>
</div>
</div>
<p>When the odds are lower than 1, the probability of success is lower than the probability of failure. When the odds are greater than 1 the probability of success is higher.</p>
</section>
<section id="exploring-odds-and-odds-ratios-2" class="slide level2">
<h2>Exploring, odds and odds ratios</h2>
<p>We can also calculate all the possible comparisons. Note that depending on the numerator/denominator the odds ratio is different, but we can simply take the inverse to switch numerator and numerator. Interpreting odds ratio &gt; 1 is usually more intuitive.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>     anger / disgust         anger / fear    anger / happiness 
               0.929                9.500                0.229 
     anger / sadness     anger / surprise       disgust / fear 
               0.468                0.125               10.231 
 disgust / happiness    disgust / sadness   disgust / surprise 
               0.247                0.504                0.135 
    fear / happiness       fear / sadness      fear / surprise 
               0.024                0.049                0.013 
 happiness / sadness happiness / surprise   sadness / surprise 
               2.041                0.545                0.267 </code></pre>
</div>
</div>
<p>For example, <code>happiness / sadness ~ 2.04</code> means that the odds (not the probability) of a correct response is 2 times higher for happy faces compared to sad faces.</p>
</section></section>
<section>
<section id="model" class="title-slide slide level1 center">
<h1>Model</h1>

</section>
<section id="the-glm-function" class="slide level2">
<h2>The <code>glm</code> function</h2>
<p>In R we can fit a GLM with the <code>glm</code> function. The syntax is the same as the <code>lm</code> (for standard linear models). We only need to specify the <strong>random component</strong> and the <strong>link function</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">*</span> x4, <span class="co"># systematic component (linear predictor)</span></span>
<span id="cb22-2"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data,</span>
<span id="cb22-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)) <span class="co"># random component and link function</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Clearly, the <code>y</code> in this example need to be consistent with the chosen family. In this case the model is expecting a 0-1 vector. If we provide labels (characters) or number &gt; 1 or &lt; 0 the function will fail.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>A <code>glm</code> with <code>family = gaussian(link = "identity")</code> is the same as running a <code>lm</code>. Internally <code>glm</code> calls <code>lm</code> in this case.</p>
</div>
</div>
</div>
</section>
<section id="the-null-model" class="slide level2">
<h2>The null model</h2>
<p>We can start with the easiest model that is a model without the systematic component (with no predictors).</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb23-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit0)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = acc ~ 1, family = binomial(link = "logit"), data = dat)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -0.03244    0.10399  -0.312    0.755

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 512.83  on 369  degrees of freedom
Residual deviance: 512.83  on 369  degrees of freedom
AIC: 514.83

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div>
</section>
<section id="the-null-model-1" class="slide level2">
<h2>The null model</h2>

<img data-src="img/fit0_summary.png" class="r-stretch"></section>
<section id="the-null-model-formally" class="slide level2">
<h2>The null model, formally</h2>
<p><span class="math display">\[
\eta_i = \beta_0
\]</span></p>
<p><span class="math display">\[
p_i = g^{-1}(\eta_i) = g^{-1}(\beta_0)
\]</span></p>
<p><span class="math inline">\(g^{-1}(\cdot)\)</span> is the inverse-logit link:</p>
<p><span class="math display">\[
p_i = \frac{e^{\beta_0}}{1 + e^{\beta_0}}
\]</span></p>
<p>In other terms, the probability can be calculated inverting the logit link function evaluated on the linear predictor <span class="math inline">\(\eta\)</span>. In this case <span class="math inline">\(\eta\)</span> only contains <span class="math inline">\(\beta_0\)</span>.</p>
</section>
<section id="the-null-model-interpretation" class="slide level2">
<h2>The null model, interpretation</h2>
<p>In this case, the intercept is -0.032. The intercept is the expected value (i.e., the mean) of <code>y</code> (accuracy here) when everything is zero. In this case <span class="math inline">\(\beta_0\)</span> is just the (logit transformed) overall accuracy.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit0)[<span class="st">"(Intercept)"</span>]</span>
<span id="cb25-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(b0) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(b0)) <span class="co"># inverse logit</span></span>
<span id="cb25-3"><a aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) </span></span>
<span id="cb25-4"><a aria-hidden="true" tabindex="-1"></a><span class="do">##   0.4918919</span></span>
<span id="cb25-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(b0)              <span class="co"># directly with the dedicated function</span></span>
<span id="cb25-6"><a aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) </span></span>
<span id="cb25-7"><a aria-hidden="true" tabindex="-1"></a><span class="do">##   0.4918919</span></span>
<span id="cb25-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat<span class="sc">$</span>acc)           <span class="co"># average accuracy</span></span>
<span id="cb25-9"><a aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.4918919</span></span>
<span id="cb25-10"><a aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">odds</span>(<span class="fu">mean</span>(dat<span class="sc">$</span>acc))) <span class="co"># probability to logit</span></span>
<span id="cb25-11"><a aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.03243528</span></span>
<span id="cb25-12"><a aria-hidden="true" tabindex="-1"></a><span class="fu">qlogis</span>(<span class="fu">mean</span>(dat<span class="sc">$</span>acc)) <span class="co"># probability to logit with the dedicated function</span></span>
<span id="cb25-13"><a aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.03243528</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="categorical-predictor-emotion" class="slide level2">
<h2>Categorical predictor, emotion</h2>
<p>Then we can include <code>emotion_lbl</code> as predictor. Let’s see what happens:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a>fit_em <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> emotion_lbl, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb26-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_em)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = acc ~ emotion_lbl, family = binomial(link = "logit"), 
    data = dat)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          -0.69315    0.38730  -1.790  0.07350 .  
emotion_lbldisgust    0.07411    0.44040   0.168  0.86637    
emotion_lblfear      -2.25129    0.82235  -2.738  0.00619 ** 
emotion_lblhappiness  1.47331    0.46507   3.168  0.00154 ** 
emotion_lblsadness    0.75984    0.46555   1.632  0.10266    
emotion_lblsurprise   2.07944    0.48917   4.251 2.13e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 512.83  on 369  degrees of freedom
Residual deviance: 423.88  on 364  degrees of freedom
AIC: 435.88

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="categorical-predictor-emotion-1" class="slide level2">
<h2>Categorical predictor, emotion</h2>
<p>Now we have 6 coefficients. As in standard linear models, by default, categorical predictors are transformed into dummy variables:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(<span class="fu">model.matrix</span>(<span class="sc">~</span> emotion_lbl, <span class="at">data =</span> dat))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) emotion_lbldisgust emotion_lblfear emotion_lblhappiness
1            1                  0               1                    0
2            1                  1               0                    0
3            1                  0               0                    1
8            1                  0               0                    0
15           1                  0               0                    0
42           1                  0               0                    0
   emotion_lblsadness emotion_lblsurprise
1                   0                   0
2                   0                   0
3                   0                   0
8                   1                   0
15                  0                   1
42                  0                   0</code></pre>
</div>
</div>
<p>The intercept is the reference level (in this case <code>anger</code>) and the other 5 coefficients represent the comparison between all emotions vs anger.</p>
</section>
<section id="categorical-predictor-emotion-2" class="slide level2 smaller">
<h2>Categorical predictor, emotion</h2>
<p>Remember that we are working on the link-function space where comparisons are expressed in logit. <span class="math inline">\(\beta_1\)</span> (<code>emotion_lbldisgust</code>) is the comparison between <code>disgust</code> and <code>anger</code>. Formally:</p>
<p><span class="math display">\[
\beta_1 = \mbox{logit}(p(y = 1 | \mbox{disgust})) - \mbox{logit}(p(y = 1 | \mbox{anger}))
\]</span></p>
<p>But the logit is the logarithm of the odds (let’s call <span class="math inline">\(p_a\)</span> and <span class="math inline">\(p_d\)</span> anger and disgust respectively)</p>
<p><span class="math display">\[
\log{\frac{p_d}{1 - p_d}} - \log{\frac{p_a}{1 - p_a}}
\]</span></p>
<p>A difference of logs can be expressed as the log of the ratio:</p>
<p><span class="math display">\[
\log{\frac{\frac{p_d}{1 - p_d}}{\frac{p_a}{1 - p_a}}}
\]</span></p>
<p>Finally we can take the exponential to remove the log:</p>
<p><span class="math display">\[
e^{\log{\frac{\frac{p_d}{1 - p_d}}{\frac{p_a}{1 - p_a}}}} = \frac{\frac{p_d}{1 - p_d}}{\frac{p_a}{1 - p_a}}
\]</span></p>
<p>This is exactly the odds ratio! This means that taking the exponential of <span class="math inline">\(\beta_1\)</span> returns the estimated odds ratio for that comparison.</p>
</section>
<section id="categorical-predictor" class="slide level2">
<h2>Categorical predictor</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit_em)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         (Intercept)   emotion_lbldisgust      emotion_lblfear 
         -0.69314718           0.07410797          -2.25129179 
emotion_lblhappiness   emotion_lblsadness  emotion_lblsurprise 
          1.47330574           0.75983856           2.07944154 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(fit_em))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         (Intercept)   emotion_lbldisgust      emotion_lblfear 
           0.5000000            1.0769231            0.1052632 
emotion_lblhappiness   emotion_lblsadness  emotion_lblsurprise 
           4.3636364            2.1379310            8.0000000 </code></pre>
</div>
</div>
<p>Comparing with the manual calculation:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" tabindex="-1"></a>p_d <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>acc[dat<span class="sc">$</span>emotion_lbl <span class="sc">==</span> <span class="st">"disgust"</span>])</span>
<span id="cb34-2"><a aria-hidden="true" tabindex="-1"></a>p_a <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>acc[dat<span class="sc">$</span>emotion_lbl <span class="sc">==</span> <span class="st">"anger"</span>])</span>
<span id="cb34-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">or</span>(p_d, p_a)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.076923</code></pre>
</div>
</div>
</section>
<section id="main-effect-of-emotion" class="slide level2">
<h2>Main effect of <code>emotion</code></h2>
<p>We can also assess the effect of <code>emotion_lbl</code> using a Likelihood Ratio Test (LRT). Basically we can compare the model with or without the <code>emotion_lbl</code> predictor. Using the LRT we are setting the effect of <code>emotion_lbl</code> to zero. This means that the null hypothesis is that all possible contrasts among emotions are zero.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit0, fit_em) <span class="co"># comparing two models</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: acc ~ 1
Model 2: acc ~ emotion_lbl
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1       369     512.83                          
2       364     423.88  5   88.955 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit_em)  <span class="co"># using the car::Anova</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: acc
            LR Chisq Df Pr(&gt;Chisq)    
emotion_lbl   88.955  5  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="confidence-intervals" class="slide level2">
<h2>Confidence intervals</h2>
<p>The confidence intervals for model parameters can be extracted with the <code>confint.default()</code> function. These are called Wald confidence intervals. They are computed as:</p>
<p><span class="math display">\[
\beta \pm q_{\alpha/2} \mbox{SE}_\beta
\]</span></p>
<p>Where <span class="math inline">\(q\)</span> is the critical test statistics (<span class="math inline">\(z\)</span> in this case) at <span class="math inline">\(\alpha\)</span> level and <span class="math inline">\(\mbox{SE}_\beta\)</span> is the standard error.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_em)<span class="sc">$</span>coefficients</span>
<span id="cb40-2"><a aria-hidden="true" tabindex="-1"></a>fits</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept)          -0.69314718  0.3872983 -1.7896983 0.0735024219
emotion_lbldisgust    0.07410797  0.4404044  0.1682725 0.8663688694
emotion_lblfear      -2.25129179  0.8223512 -2.7376280 0.0061884033
emotion_lblhappiness  1.47330574  0.4650676  3.1679388 0.0015352381
emotion_lblsadness    0.75983856  0.4655543  1.6321158 0.1026550954
emotion_lblsurprise   2.07944154  0.4891684  4.2509728 0.0000212844</code></pre>
</div>
</div>
</section>
<section id="confidence-intervals-1" class="slide level2">
<h2>Confidence intervals</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" tabindex="-1"></a>(z <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qnorm</span>(<span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>))) <span class="co"># critical test statistics at alpha/2 (two tails)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb44-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> fits[, <span class="st">"Estimate"</span>] <span class="sc">-</span> z <span class="sc">*</span> fits[, <span class="st">"Std. Error"</span>],</span>
<span id="cb44-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> fits[, <span class="st">"Estimate"</span>] <span class="sc">+</span> z <span class="sc">*</span> fits[, <span class="st">"Std. Error"</span>]</span>
<span id="cb44-4"><a aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          lower       upper
(Intercept)          -1.4522380  0.06594361
emotion_lbldisgust   -0.7890688  0.93728475
emotion_lblfear      -3.8630706 -0.63951297
emotion_lblhappiness  0.5617900  2.38482150
emotion_lblsadness   -0.1526311  1.67230825
emotion_lblsurprise   1.1206891  3.03819397</code></pre>
</div>
</div>
</section>
<section id="confidence-intervals-2" class="slide level2">
<h2>Confidence intervals</h2>
<p>Or directly using the <code>confint.default()</code></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">confint.default</span>(fit_em)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          2.5 %      97.5 %
(Intercept)          -1.4522380  0.06594361
emotion_lbldisgust   -0.7890688  0.93728475
emotion_lblfear      -3.8630706 -0.63951297
emotion_lblhappiness  0.5617900  2.38482150
emotion_lblsadness   -0.1526311  1.67230825
emotion_lblsurprise   1.1206891  3.03819397</code></pre>
</div>
</div>
</section>
<section id="confidence-intervals-3" class="slide level2">
<h2>Confidence intervals</h2>
<p>But these are confidence intervals of log odds ratios (differences in logit). To obtain confidence intervals of odds ratios we can just take the exponential of the upper and lower bound:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint.default</span>(fit_em))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          2.5 %     97.5 %
(Intercept)          0.23404591  1.0681665
emotion_lbldisgust   0.45426761  2.5530399
emotion_lblfear      0.02100341  0.5275493
emotion_lblhappiness 1.75380897 10.8571245
emotion_lblsadness   0.85844631  5.3244438
emotion_lblsurprise  3.06696696 20.8675218</code></pre>
</div>
</div>
<p>Notice that, for differences in logit the <em>null</em> value is zero. Taking <span class="math inline">\(e^0 = 1\)</span> thus the <em>null</em> value of an odds ratio is 1 (numerator is the same as the denominator).</p>
</section>
<section id="confidence-intervals-4" class="slide level2">
<h2>Confidence intervals</h2>
<p>The real default for confidence intervals using just <code>confint()</code> (and not <code>confint.default()</code>) are the so-called profile likelihood confidence intervals. The main difference is that Wald confidence intervals are symmetric by definition while the profile likelihood not necessary.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit_em)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          2.5 %      97.5 %
(Intercept)          -1.4942114  0.04295714
emotion_lbldisgust   -0.7729310  0.96810000
emotion_lblfear      -4.1872943 -0.80517570
emotion_lblhappiness  0.5830921  2.41838129
emotion_lblsadness   -0.1359529  1.70183598
emotion_lblsurprise   1.1479829  3.07708494</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># you can also do exp(confint(fit_em))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In this case they are very similar to the Wald but is not always like this.</p>

<aside><div>
<p>See this <a href="https://thestatsgeek.com/2014/02/08/wald-vs-likelihood-ratio-test/">post</a> for a nice overview.</p>
</div></aside></section>
<section id="specific-contrasts-of-emotion-levels" class="slide level2">
<h2>Specific contrasts of <code>emotion</code> levels</h2>
<p>We can also test some specific contrasts using the <code>emmeans</code> or the <code>multcomp</code> package. For example:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb53-2"><a aria-hidden="true" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fit_em, <span class="sc">~</span> emotion_lbl)</span>
<span id="cb53-3"><a aria-hidden="true" tabindex="-1"></a>mm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> emotion_lbl  emmean    SE  df asymp.LCL asymp.UCL
 anger       -0.6931 0.387 Inf    -1.452    0.0659
 disgust     -0.6190 0.210 Inf    -1.030   -0.2081
 fear        -2.9444 0.725 Inf    -4.366   -1.5226
 happiness    0.7802 0.257 Inf     0.276    1.2848
 sadness      0.0667 0.258 Inf    -0.440    0.5730
 surprise     1.3863 0.299 Inf     0.801    1.9719

Results are given on the logit (not the response) scale. 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>These are called <strong>e</strong>stimated <strong>m</strong>rginal <strong>means</strong>. Importantly, the <code>emmeans</code> package uses the model and not the data. Marginal means will depend on the fitted model.</p>
</section>
<section id="specific-contrasts-of-emotion-levels-1" class="slide level2">
<h2>Specific contrasts of <code>emotion</code> levels</h2>
<p>We would expect estimated probabilities but we have values in logit (this is why we have negative values). We can also transform the logit into probabilities:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(fit_em, <span class="sc">~</span> emotion_lbl, <span class="at">type =</span> <span class="st">"response"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<pre><code> emotion_lbl  prob     SE  df asymp.LCL asymp.UCL
 anger       0.333 0.0861 Inf    0.1897     0.516
 disgust     0.350 0.0477 Inf    0.2631     0.448
 fear        0.050 0.0345 Inf    0.0125     0.179
 happiness   0.686 0.0555 Inf    0.5685     0.783
 sadness     0.517 0.0645 Inf    0.3918     0.639
 surprise    0.800 0.0478 Inf    0.6901     0.878

Confidence level used: 0.95 
<span class="hg">Intervals are back-transformed from the logit scale </span>
</code></pre>
</div>
</section>
<section id="what-emmeans-is-doing" class="slide level2">
<h2>What <code>emmeans</code> is doing?</h2>
<p>To understand what <code>emmeans</code> is doing we need to introduce the term prediction. Given the predictors we ask the model the predicted logit or probability.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># prediction for the first 5 trials. </span></span>
<span id="cb56-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># The best prediction of the model is the (logit) mean</span></span>
<span id="cb56-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(fit0, <span class="at">type =</span> <span class="st">"link"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5           6 
-0.03243528 -0.03243528 -0.03243528 -0.03243528 -0.03243528 -0.03243528 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># prediction for the first 5 trials. </span></span>
<span id="cb58-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># the prediction depend on the emotion</span></span>
<span id="cb58-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(fit_em, <span class="at">type =</span> <span class="st">"link"</span>)) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          2          3          4          5          6 
-2.9444390 -0.6190392  0.7801586  0.7801586 -0.6190392 -2.9444390 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(fit_em, <span class="at">type =</span> <span class="st">"response"</span>)) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6 
0.0500000 0.3500000 0.6857143 0.6857143 0.3500000 0.0500000 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">plogis</span>(<span class="fu">predict</span>(fit_em, <span class="at">type =</span> <span class="st">"link"</span>))) <span class="co"># same</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6 
0.0500000 0.3500000 0.6857143 0.6857143 0.3500000 0.0500000 </code></pre>
</div>
</div>
</section>
<section id="what-emmeans-is-doing-1" class="slide level2">
<h2>What <code>emmeans</code> is doing?</h2>
<p>For example, to know what is the predicted accuracy for <code>anger</code> and <code>disgust</code> we can do:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit_em, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">emotion_lbl =</span> <span class="fu">c</span>(<span class="st">"anger"</span>, <span class="st">"disgust"</span>)), <span class="at">type =</span> <span class="st">"response"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2 
0.3333333 0.3500000 </code></pre>
</div>
</div>
<p>Or manually:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_em)</span>
<span id="cb66-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb66-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="fu">plogis</span>(B[<span class="st">"(Intercept)"</span>]), <span class="co"># anger</span></span>
<span id="cb66-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="fu">plogis</span>(B[<span class="st">"(Intercept)"</span>] <span class="sc">+</span> B[<span class="st">"emotion_lbldisgust"</span>]) <span class="co"># disgust</span></span>
<span id="cb66-5"><a aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) (Intercept) 
  0.3333333   0.3500000 </code></pre>
</div>
</div>
<p>On the logit scale, we can do linear combinations of coefficients. This is not valid on the probability scale, this is the reason why we need the link function.</p>
</section>
<section id="what-emmeans-is-doing-2" class="slide level2">
<h2>What <code>emmeans</code> is doing?</h2>
<p>For reproducing the entire <code>emmeans</code> output we just need to provide all emotions into <code>newdata =</code></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">emotion_lbl =</span> <span class="fu">unique</span>(dat<span class="sc">$</span>emotion_lbl))</span>
<span id="cb68-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">predict</span>(fit_em, <span class="at">newdata =</span> nd, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"response"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fit     se.fit residual.scale
1 0.0500000 0.03445835              1
2 0.3500000 0.04769696              1
3 0.6857143 0.05548619              1
4 0.5166667 0.06451385              1
5 0.8000000 0.04780914              1
6 0.3333333 0.08606630              1</code></pre>
</div>
</div>
</section>
<section id="contrasts-with-emmeans" class="slide level2">
<h2>Contrasts with <code>emmeans</code></h2>
<p>We can also compute all contrasts across emotions:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># or emmeans(fit_em, pairwise ~ emotion_lbl)</span></span>
<span id="cb70-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(mm, <span class="at">p.adjust =</span> <span class="st">"bonferroni"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast             estimate    SE  df z.ratio p.value
 anger - disgust       -0.0741 0.440 Inf  -0.168  1.0000
 anger - fear           2.2513 0.822 Inf   2.738  0.0680
 anger - happiness     -1.4733 0.465 Inf  -3.168  0.0192
 anger - sadness       -0.7598 0.466 Inf  -1.632  0.5771
 anger - surprise      -2.0794 0.489 Inf  -4.251  0.0003
 disgust - fear         2.3254 0.755 Inf   3.079  0.0253
 disgust - happiness   -1.3992 0.332 Inf  -4.214  0.0004
 disgust - sadness     -0.6857 0.333 Inf  -2.061  0.3080
 disgust - surprise    -2.0053 0.365 Inf  -5.494  &lt;.0001
 fear - happiness      -3.7246 0.770 Inf  -4.839  &lt;.0001
 fear - sadness        -3.0111 0.770 Inf  -3.910  0.0013
 fear - surprise       -4.3307 0.785 Inf  -5.520  &lt;.0001
 happiness - sadness    0.7135 0.365 Inf   1.956  0.3679
 happiness - surprise  -0.6061 0.394 Inf  -1.537  0.6404
 sadness - surprise    -1.3196 0.395 Inf  -3.341  0.0108

Results are given on the log odds ratio (not the response) scale. 
P value adjustment: tukey method for comparing a family of 6 estimates </code></pre>
</div>
</div>
<p>Be careful to the multiple comparison approach! You can use the <code>p.adjust =</code> argument and choose an appropriate method.</p>
</section>
<section id="contrasts-with-emmeans-1" class="slide level2">
<h2>Contrasts with <code>emmeans</code></h2>
<p>Some of these contrasts are also the model parameters:</p>
<div class="cell" data-layout-align="center">
<pre><code> contrast             estimate    SE  df z.ratio p.value
<span class="hg"> anger - disgust       -0.0741 0.440 Inf  -0.168  1.0000</span>
<span class="hg"> anger - fear           2.2513 0.822 Inf   2.738  0.0680</span>
<span class="hg"> anger - happiness     -1.4733 0.465 Inf  -3.168  0.0192</span>
<span class="hg"> anger - sadness       -0.7598 0.466 Inf  -1.632  0.5771</span>
<span class="hg"> anger - surprise      -2.0794 0.489 Inf  -4.251  0.0003</span>
 disgust - fear         2.3254 0.755 Inf   3.079  0.0253
 disgust - happiness   -1.3992 0.332 Inf  -4.214  0.0004
 disgust - sadness     -0.6857 0.333 Inf  -2.061  0.3080
 disgust - surprise    -2.0053 0.365 Inf  -5.494  &lt;.0001
 fear - happiness      -3.7246 0.770 Inf  -4.839  &lt;.0001
 fear - sadness        -3.0111 0.770 Inf  -3.910  0.0013
 fear - surprise       -4.3307 0.785 Inf  -5.520  &lt;.0001
 happiness - sadness    0.7135 0.365 Inf   1.956  0.3679
 happiness - surprise  -0.6061 0.394 Inf  -1.537  0.6404
 sadness - surprise    -1.3196 0.395 Inf  -3.341  0.0108

Results are given on the log odds ratio (not the response) scale. 
P value adjustment: tukey method for comparing a family of 6 estimates 
</code></pre>
</div>
</section>
<section id="contrasts-with-emmeans-2" class="slide level2">
<h2>Contrasts with <code>emmeans</code></h2>
<p>You can also express the contrasts into the probability space. We are just taking the exponential thus transforming differences of logit into odds ratios.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(mm, <span class="at">type =</span> <span class="st">"response"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast             odds.ratio     SE  df null z.ratio p.value
 anger / disgust          0.9286 0.4090 Inf    1  -0.168  1.0000
 anger / fear             9.5000 7.8100 Inf    1   2.738  0.0680
 anger / happiness        0.2292 0.1070 Inf    1  -3.168  0.0192
 anger / sadness          0.4677 0.2180 Inf    1  -1.632  0.5771
 anger / surprise         0.1250 0.0611 Inf    1  -4.251  0.0003
 disgust / fear          10.2308 7.7300 Inf    1   3.079  0.0253
 disgust / happiness      0.2468 0.0819 Inf    1  -4.214  0.0004
 disgust / sadness        0.5037 0.1680 Inf    1  -2.061  0.3080
 disgust / surprise       0.1346 0.0491 Inf    1  -5.494  &lt;.0001
 fear / happiness         0.0241 0.0186 Inf    1  -4.839  &lt;.0001
 fear / sadness           0.0492 0.0379 Inf    1  -3.910  0.0013
 fear / surprise          0.0132 0.0103 Inf    1  -5.520  &lt;.0001
 happiness / sadness      2.0411 0.7440 Inf    1   1.956  0.3679
 happiness / surprise     0.5455 0.2150 Inf    1  -1.537  0.6404
 sadness / surprise       0.2672 0.1060 Inf    1  -3.341  0.0108

P value adjustment: tukey method for comparing a family of 6 estimates 
Tests are performed on the log odds ratio scale </code></pre>
</div>
</div>
<p>Notice that: <em>Tests are performed on the log odds ratio scale</em></p>
</section>
<section id="custom-contrasts" class="slide level2">
<h2>Custom contrasts</h2>
<p>Clearly you can also provide custom contrasts like <code>contr.sum()</code> or <code>MASS::contr.sdiff()</code> (for comparing the next level with the previous level). For an overview about contrasts coding see <span class="citation" data-cites="Granziol2025-sy">Granziol et al. (<a href="#/references" role="doc-biblioref" onclick="">2025</a>)</span> and <span class="citation" data-cites="Schad2020-ht">Schad et al. (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(mm, <span class="st">"consec"</span>) <span class="co"># consec ~ MASS::contr.sdif()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate    SE  df z.ratio p.value
 disgust - anger       0.0741 0.440 Inf   0.168  0.9999
 fear - disgust       -2.3254 0.755 Inf  -3.079  0.0089
 happiness - fear      3.7246 0.770 Inf   4.839  &lt;.0001
 sadness - happiness  -0.7135 0.365 Inf  -1.956  0.1973
 surprise - sadness    1.3196 0.395 Inf   3.341  0.0036

Results are given on the log odds ratio (not the response) scale. 
P value adjustment: mvt method for 5 tests </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># see ?emmeans::contrast</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Here we are comparing 2 vs 1, 2 vs 3, 3 vs 4, etc.</p>
</section>
<section id="plotting" class="slide level2">
<h2>Plotting</h2>
<p>There are several options to plot the model results. In this case we could plot the predicted probability for each emotion and the confidence intervals. You can use the <code>effects</code> package or <code>ggeffects</code> (that internally uses <code>effects</code>) to create <code>ggplot2</code> objects.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb77-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># grid of prediction and CI (as we did with emmeans or predict())</span></span>
<span id="cb77-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">ggeffect</span>(fit_em, <span class="st">"emotion_lbl"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted probabilities of acc

emotion_lbl | Predicted |     95% CI
------------------------------------
anger       |      0.33 | 0.19, 0.52
disgust     |      0.35 | 0.26, 0.45
fear        |      0.05 | 0.01, 0.18
happiness   |      0.69 | 0.57, 0.78
sadness     |      0.52 | 0.39, 0.64
surprise    |      0.80 | 0.69, 0.88</code></pre>
</div>
</div>
</section>
<section id="plotting-1" class="slide level2">
<h2>Plotting</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># this return a ggplot2 object, you can add layers with +</span></span>
<span id="cb79-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ggeffect</span>(fit_em, <span class="st">"emotion_lbl"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-39-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="numerical-predictor-effect-of-intensity" class="slide level2">
<h2>Numerical predictor, effect of <code>intensity</code></h2>
<p>Now let’s fit a model with only the effect of intensity.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a aria-hidden="true" tabindex="-1"></a>fit_int <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> intensity, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb80-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_int)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = acc ~ intensity, family = binomial(link = "logit"), 
    data = dat)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.797692   0.263646  -6.819 9.19e-12 ***
intensity    0.031976   0.004291   7.452 9.19e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 512.83  on 369  degrees of freedom
Residual deviance: 447.05  on 368  degrees of freedom
AIC: 451.05

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</section>
<section id="numerical-predictor-effect-of-intensity-1" class="slide level2">
<h2>Numerical predictor, effect of <code>intensity</code></h2>
<p>Now the intercept is the logit accuracy when <code>intensity</code> is zero (that is not really a meaningful value). <span class="math inline">\(\beta_1\)</span> here is the expected increase in logit for a unit increase in intensity. In other terms, moving from intensity e.g., 10 to 11 increase the logit of 0.03.</p>
<p>As for the emotion, we can take the exponential of <span class="math inline">\(\beta_1\)</span> obtaining the odds ratio of increasing 1 unit in intensity:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(fit_int))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   intensity 
  0.1656809   1.0324926 </code></pre>
</div>
</div>
<p>We have an odds ratio of 1.03 that is quite low (1 is the null value). But this is a scale problem, 1 point in the intensity scale is meaningless.</p>
</section>
<section id="numerical-predictor-effect-of-intensity-2" class="slide level2">
<h2>Numerical predictor, effect of <code>intensity</code></h2>
<p>Before improving the model, notice that the story is the same regardless having categorical or numerical predictor. For categorical predictors the coefficients are odds ratios (or difference in logit) comparing levels (<code>anger</code> vs <code>fear</code>). For numerical predictor the coefficients are odds ratios (or difference in logit) comparing values separated by 1 unit (in the scale of the predictor).</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a aria-hidden="true" tabindex="-1"></a>(pp <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_int, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">intensity =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2 
-1.318054 -1.286078 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(pp) <span class="co"># same as b1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         2 
0.03197586 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">diff</span>(pp))  <span class="co"># same as exp(b1)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       2 
1.032493 </code></pre>
</div>
</div>
</section>
<section id="numerical-predictor-effect-of-intensity-3" class="slide level2">
<h2>Numerical predictor, effect of <code>intensity</code></h2>
<p>In fact, we can clearly see that on the logit scale the effect is linear while on the probability scale is not linear.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># pairs of unit differences in different positions of x</span></span>
<span id="cb90-2"><a aria-hidden="true" tabindex="-1"></a>diffs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>), <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">51</span>), <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">81</span>))</span>
<span id="cb90-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(diffs, <span class="cf">function</span>(d) <span class="fu">diff</span>(<span class="fu">predict</span>(fit_int, <span class="fu">data.frame</span>(<span class="at">intensity =</span> d))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         2          2          2 
0.03197586 0.03197586 0.03197586 </code></pre>
</div>
</div>
<p>But is not the same when we take differences in probabilities</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># pairs of unit differences in different positions of x</span></span>
<span id="cb92-2"><a aria-hidden="true" tabindex="-1"></a>diffs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>), <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">51</span>), <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">81</span>))</span>
<span id="cb92-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(diffs, <span class="cf">function</span>(d) <span class="fu">diff</span>(<span class="fu">predict</span>(fit_int, <span class="fu">data.frame</span>(<span class="at">intensity =</span> d), <span class="at">type =</span> <span class="st">"response"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          2           2           2 
0.004884715 0.007927308 0.006900733 </code></pre>
</div>
</div>
</section>
<section id="numerical-predictor-effect-of-intensity-4" class="slide level2">
<h2>Numerical predictor, effect of <code>intensity</code></h2>
<p>Same increase in <code>intensity</code> produces a different increase on the probability scale but not on the logit scale.</p>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-45-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="numerical-predictor-marginal-effects" class="slide level2">
<h2>Numerical predictor, marginal effects</h2>
<p>This means that for interpreting results in the probability scale (what we actually want) we cannot think in linear terms (as in standard linear regression). For each value of <code>intensity</code> we have a different slope (i.e., derivative).</p>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-46-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="marginal-effects" class="slide level2">
<h2>Marginal effects</h2>
<p>Now let’s plot all the red slopes and see what we can learn:</p>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-47-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="marginal-effects-a-really-comprehensive-framework" class="slide level2">
<h2>Marginal effects: a really comprehensive framework</h2>
<p>The <code>marginaleffects</code> <a href="https://marginaleffects.com/">package</a> provide a very complete and comprehensive framework to compute marginal effects for several models. You can have a very detailed overview of the theory and the functions reading:</p>
<ul>
<li>The main paper by <span class="citation" data-cites="Arel-Bundock2024-zl">Arel-Bundock et al. (<a href="#/references" role="doc-biblioref" onclick="">2024</a>)</span></li>
<li><a href="https://www.youtube.com/watch?v=ANDC_kkAjeM">https://www.youtube.com/watch?v=ANDC_kkAjeM</a></li>
</ul>
</section>
<section id="marginal-effects-of-intensity" class="slide level2">
<h2>Marginal effects of <code>intensity</code></h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb94-2"><a aria-hidden="true" tabindex="-1"></a>sl <span class="ot">&lt;-</span> <span class="fu">slopes</span>(fit_int)</span>
<span id="cb94-3"><a aria-hidden="true" tabindex="-1"></a>sl</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error     z Pr(&gt;|z|)     S   2.5 %  97.5 %
  0.00796   0.001061  7.51   &lt;0.001  43.9 0.00589 0.01004
  0.00796   0.001061  7.51   &lt;0.001  43.9 0.00589 0.01004
  0.00762   0.000938  8.12   &lt;0.001  51.0 0.00578 0.00946
  0.00507   0.000362 14.01   &lt;0.001 145.7 0.00436 0.00578
  0.00796   0.001061  7.51   &lt;0.001  43.9 0.00589 0.01004
--- 360 rows omitted. See ?print.marginaleffects ---
  0.00484   0.000351 13.77   &lt;0.001 140.8 0.00415 0.00552
  0.00748   0.000905  8.27   &lt;0.001  52.7 0.00571 0.00925
  0.00507   0.000362 14.01   &lt;0.001 145.7 0.00436 0.00578
  0.00694   0.000725  9.57   &lt;0.001  69.7 0.00552 0.00836
  0.00748   0.000905  8.27   &lt;0.001  52.7 0.00571 0.00925
Term: intensity
Type: response
Comparison: dY/dX</code></pre>
</div>
</div>
</section>
<section id="marginal-effects-of-intensity-1" class="slide level2">
<h2>Marginal effects of <code>intensity</code></h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># average marginal effect</span></span>
<span id="cb96-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(fit_int)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error  z Pr(&gt;|z|)    S   2.5 %  97.5 %
  0.00664   0.000602 11   &lt;0.001 91.7 0.00546 0.00782

Term: intensity
Type: response
Comparison: dY/dX</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># max marginal effect</span></span>
<span id="cb98-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(sl, estimate <span class="sc">==</span> <span class="fu">max</span>(estimate))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error    z Pr(&gt;|z|)    S   2.5 % 97.5 %
  0.00796    0.00106 7.51   &lt;0.001 43.9 0.00589   0.01
  0.00796    0.00106 7.51   &lt;0.001 43.9 0.00589   0.01
  0.00796    0.00106 7.51   &lt;0.001 43.9 0.00589   0.01
  0.00796    0.00106 7.51   &lt;0.001 43.9 0.00589   0.01
  0.00796    0.00106 7.51   &lt;0.001 43.9 0.00589   0.01
--- 27 rows omitted. See ?print.marginaleffects ---
  0.00796    0.00106 7.51   &lt;0.001 43.9 0.00589   0.01
  0.00796    0.00106 7.51   &lt;0.001 43.9 0.00589   0.01
  0.00796    0.00106 7.51   &lt;0.001 43.9 0.00589   0.01
  0.00796    0.00106 7.51   &lt;0.001 43.9 0.00589   0.01
  0.00796    0.00106 7.51   &lt;0.001 43.9 0.00589   0.01
Term: intensity
Type: response
Comparison: dY/dX</code></pre>
</div>
</div>
</section>
<section id="plotting-2" class="slide level2">
<h2>Plotting</h2>
<p>The pattern for intensity is almost linear, this is why we have more than one maximum.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ggeffect</span>(fit_int, <span class="st">"intensity"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-50-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="inverse-estimation" class="slide level2">
<h2>Inverse estimation</h2>
<p>We can also do what is called inverse estimation (common in Psychophysics). We can ask the model what is the level of <code>intensity</code> required to achieve a certain accuracy.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">dose.p</span>(fit_int, <span class="at">p =</span> <span class="fl">0.75</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Dose       SE
p = 0.75: 90.57784 5.916972</code></pre>
</div>
</div>
<p>Furthermore, we need roughly 90% of <code>intensity</code> to have an accuracy of 75%.</p>
</section>
<section id="improving-the-model" class="slide level2">
<h2>Improving the model</h2>
<p>We have two problems in terms of interpretability in this model:</p>
<ul>
<li>The intercept is meaningless because 0% intensity is not a plausible value</li>
<li>Intensity from 0% to 100% in steps of 1% is too granular</li>
</ul>
<p>We can center the variable on the minimum (0 become 10%) and rescale the variable from 0 (10%) to 10 (100%) where the unit increase is 10%.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>intensity10 <span class="ot">&lt;-</span> (dat<span class="sc">$</span>intensity <span class="sc">-</span> <span class="dv">10</span>) <span class="sc">/</span> <span class="dv">10</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="additive-model-intensity-and-emotion" class="slide level2">
<h2>Additive model, <code>intensity</code> and <code>emotion</code></h2>
<p>We can now fit a model with the additive effect of emotion and intensity. To simplify the pattern let’s keep only two emotions.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a aria-hidden="true" tabindex="-1"></a>fit_int_emo <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> intensity10 <span class="sc">+</span> emotion_lbl, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">subset =</span> emotion_lbl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"anger"</span>, <span class="st">"surprise"</span>))</span>
<span id="cb104-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_int_emo)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = acc ~ intensity10 + emotion_lbl, family = binomial(link = "logit"), 
    data = dat, subset = emotion_lbl %in% c("anger", "surprise"))

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          -5.2155     1.2367  -4.217 2.47e-05 ***
intensity10           0.8363     0.1858   4.502 6.73e-06 ***
emotion_lblsurprise   4.1623     1.0010   4.158 3.21e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 128.207  on 99  degrees of freedom
Residual deviance:  63.942  on 97  degrees of freedom
AIC: 69.942

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
</section>
<section id="additive-model-intensity-and-emotion-1" class="slide level2">
<h2>Additive model, <code>intensity</code> and <code>emotion</code></h2>
<p>The interpretation is the same as before. The <code>intercept</code> is the expected logit when everything is zero (intensity = 10 and emotion = anger).</p>
<p><code>intensity</code> is the increase in logit accuracy for a unit (10%) increase in intensity controlling for <code>emotion_lbl</code>.</p>
<p><code>emotion_lblsurprise</code> is the logit difference between anger and surprise controlling for <code>emotion_lbl</code>.</p>
</section>
<section id="additive-model-intensity-and-emotion-2" class="slide level2">
<h2>Additive model, <code>intensity</code> and <code>emotion</code></h2>
<p>We can have also the two main effects (not really useful with a factor with two levels):</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit_int_emo)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: acc
            LR Chisq Df Pr(&gt;Chisq)    
intensity10   44.305  1  2.809e-11 ***
emotion_lbl   32.834  1  1.004e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="additive-model-intensity-and-emotion-3" class="slide level2">
<h2>Additive model, <code>intensity</code> and <code>emotion</code></h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># composing plots</span></span>
<span id="cb108-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ggeffect</span>(fit_int_emo, <span class="st">"intensity10"</span>)) <span class="sc">+</span> </span>
<span id="cb108-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">ggeffect</span>(fit_int_emo, <span class="st">"emotion_lbl"</span>)) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-55-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="additive-model-intensity-and-emotion-4" class="slide level2">
<h2>Additive model, <code>intensity</code> and <code>emotion</code></h2>
<p>This means that we have an odds ratio of 64.22 in favor of anger and an odds ratio of 2.31 for a unit increase in intensity.</p>
<p>We can also compute again the marginal effects for <code>intensity</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(fit_int_emo)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        Term         Contrast Estimate Std. Error     z Pr(&gt;|z|)    S  2.5 %
 emotion_lbl surprise - anger   0.4667    0.07159  6.52   &lt;0.001 33.7 0.3263
 intensity10 dY/dX              0.0852    0.00751 11.35   &lt;0.001 96.7 0.0704
 97.5 %
 0.6070
 0.0999

Type: response</code></pre>
</div>
</div>
<p>This means that we have on average an 8% of increase in accuracy across different levels of <code>intensity</code>.</p>
</section>
<section id="interaction-model-intensity-and-emotion" class="slide level2">
<h2>Interaction model, <code>intensity</code> and <code>emotion</code></h2>
<p>The final model that we can try is including the interaction between <code>intensity</code> and <code>emotion</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a aria-hidden="true" tabindex="-1"></a>fit_emo_x_int <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> intensity10 <span class="sc">*</span> emotion_lbl, </span>
<span id="cb111-2"><a aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb111-3"><a aria-hidden="true" tabindex="-1"></a>                     <span class="at">subset =</span> emotion_lbl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"anger"</span>, <span class="st">"surprise"</span>))</span>
<span id="cb111-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_emo_x_int)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = acc ~ intensity10 * emotion_lbl, family = binomial(link = "logit"), 
    data = dat, subset = emotion_lbl %in% c("anger", "surprise"))

Coefficients:
                                Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                      -3.1654     1.1766  -2.690  0.00714 **
intensity10                       0.4841     0.1933   2.504  0.01228 * 
emotion_lblsurprise               1.0226     1.4454   0.707  0.47929   
intensity10:emotion_lblsurprise   0.9782     0.4738   2.065  0.03897 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 128.207  on 99  degrees of freedom
Residual deviance:  58.274  on 96  degrees of freedom
AIC: 66.274

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
</section>
<section id="interaction-model-intensity-and-emotion-1" class="slide level2">
<h2>Interaction model, <code>intensity</code> and <code>emotion</code></h2>
<p>With interactions, always visualize first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ggeffect</span>(fit_emo_x_int, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"intensity10"</span>, <span class="st">"emotion_lbl"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-58-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="interaction-model-intensity-and-emotion-2" class="slide level2">
<h2>Interaction model, <code>intensity</code> and <code>emotion</code></h2>
<p>Clearly the effect of intensity is not the same for <code>anger</code> and <code>surprise</code>. The participant reaches high accuracies faster for <code>surprised</code> faces compared to <code>angry</code> faces.</p>
<ul>
<li><code>intercept</code>: is the expected logit for <code>anger</code> and <code>intensity</code> 0 (10%). Can be considered as the accuracy for the hardest angry face.</li>
<li><code>intensity10</code>: is the increase in logit accuracy for a unit increase (10%) in intensity for <code>angry</code> faces (the red slope in the previous plot)</li>
<li><code>emotion_lblsurprise</code>: is the logit difference (log odds ratio) between <code>anger</code> and <code>surprise</code> when <code>intensity</code> is 0 (10%). Is a conditional log odds ratio for a fixed value of intensity.</li>
<li><code>intensity10:emotion_lblsurprise</code>: this is the actual interaction. Is the logit difference of the two slopes (in logit). Is the red slope vs the blue slope.</li>
</ul>
</section>
<section id="interaction-model-intensity-and-emotion-3" class="slide level2">
<h2>Interaction model, <code>intensity</code> and <code>emotion</code></h2>
<p>Let’s improve a little bit the interpretation. We can <em>center</em> the emotion applying not the dummy (or treatment) coding but the sum to zero coding.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a aria-hidden="true" tabindex="-1"></a>datsub <span class="ot">&lt;-</span> <span class="fu">filter</span>(dat, emotion_lbl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"anger"</span>, <span class="st">"surprise"</span>))</span>
<span id="cb114-2"><a aria-hidden="true" tabindex="-1"></a>datsub<span class="sc">$</span>emotion_lbl <span class="ot">&lt;-</span> <span class="fu">factor</span>(datsub<span class="sc">$</span>emotion_lbl)</span>
<span id="cb114-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(datsub<span class="sc">$</span>emotion_lbl) <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">contr.sum</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb114-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(datsub<span class="sc">$</span>emotion_lbl)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
anger    -0.5
surprise  0.5</code></pre>
</div>
</div>
</section>
<section id="interaction-model-intensity-and-emotion-4" class="slide level2">
<h2>Interaction model, <code>intensity</code> and <code>emotion</code></h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a aria-hidden="true" tabindex="-1"></a>fit_emo_x_int2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> intensity10 <span class="sc">*</span> emotion_lbl, </span>
<span id="cb116-2"><a aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> datsub, </span>
<span id="cb116-3"><a aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb116-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_emo_x_int2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = acc ~ intensity10 * emotion_lbl, family = binomial(link = "logit"), 
    data = datsub)

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -2.6541     0.7227  -3.672  0.00024 ***
intensity10                0.9732     0.2369   4.108 3.99e-05 ***
emotion_lbl1               1.0226     1.4454   0.707  0.47929    
intensity10:emotion_lbl1   0.9782     0.4738   2.065  0.03897 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 128.207  on 99  degrees of freedom
Residual deviance:  58.274  on 96  degrees of freedom
AIC: 66.274

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
</section>
<section id="interaction-model-intensity-and-emotion-5" class="slide level2">
<h2>Interaction model, <code>intensity</code> and <code>emotion</code></h2>
<p>The parameters are interpreted in the same way, but now we have a different meaning of 0:</p>
<ul>
<li>The intercept is the average logit accuracy when intensity is 10%</li>
<li><code>intensity10</code>: is the slope when <code>emotion_lbl</code> is 0 but 0 now is in the middle of <code>anger</code> and <code>surprise</code>. This means that <code>intensity10</code> is the main effect of intensity controlling for emotion.</li>
<li>The interaction is the same as before as well as the other <code>emotion_lbl1</code> parameter.</li>
</ul>
</section>
<section id="interaction-model-intensity-and-emotion-6" class="slide level2">
<h2>Interaction model, <code>intensity</code> and <code>emotion</code></h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fit_emo_x_int<span class="sc">$</span>coefficients) <span class="ot">&lt;-</span> <span class="fu">names</span>(fit_emo_x_int2<span class="sc">$</span>coefficients) <span class="co"># just for a better output, dangerous otherwise</span></span>
<span id="cb118-2"><a aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">compareCoefs</span>(fit_emo_x_int, fit_emo_x_int2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calls:
1: glm(formula = acc ~ intensity10 * emotion_lbl, family = binomial(link = 
  "logit"), data = dat, subset = emotion_lbl %in% c("anger", "surprise"))
2: glm(formula = acc ~ intensity10 * emotion_lbl, family = binomial(link = 
  "logit"), data = datsub)

                         Model 1 Model 2
(Intercept)               -3.165  -2.654
SE                         1.177   0.723
                                        
intensity10                0.484   0.973
SE                         0.193   0.237
                                        
emotion_lbl1                1.02    1.02
SE                          1.45    1.45
                                        
intensity10:emotion_lbl1   0.978   0.978
SE                         0.474   0.474
                                        </code></pre>
</div>
</div>
</section></section>
<section>
<section id="diagnostics" class="title-slide slide level1 center">
<h1>Diagnostics</h1>

</section>
<section id="deviance" class="slide level2">
<h2>Deviance</h2>
<p>When using the <code>summary()</code> function we can see that there is as section about <em>Deviance</em>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_int)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<pre><code>
Call:
glm(formula = acc ~ intensity, family = binomial(link = "logit"), 
    data = dat)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.797692   0.263646  -6.819 9.19e-12 ***
intensity    0.031976   0.004291   7.452 9.19e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

<span class="hg">    Null deviance: 512.83  on 369  degrees of freedom</span>
<span class="hg">Residual deviance: 447.05  on 368  degrees of freedom</span>
<span class="hg">AIC: 451.05</span>

Number of Fisher Scoring iterations: 4

</code></pre>
</div>
<p>This information can be used to assess the goodness of fit of the model and also to compute pseudo-<span class="math inline">\(R^2\)</span> values (see later).</p>
</section>
<section id="deviance-1" class="slide level2">
<h2>Deviance</h2>
<p>We need to define three types of models:</p>
<ul>
<li><strong>Null Model</strong>: a model without predictors (only the intercept)</li>
<li><strong>Actual Model</strong>: the model we fitted with predictors of interest</li>
<li><strong>Saturated Model</strong>: a model fitting the data perfectly (no error)</li>
</ul>
</section>
<section id="deviance-and-likelihood" class="slide level2">
<h2>Deviance and likelihood</h2>
<p>This is a visual representation of the three models. The current model should be always between the null and the saturated.</p>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-64-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="deviance-and-likelihood-1" class="slide level2">
<h2>Deviance and likelihood</h2>
<p>We can simplify the idea of likelihood and deviance thinking about the distance between the fitted line and the points. As the distance decreases, the likelihood of the model increases.</p>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-65-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="deviance-2" class="slide level2">
<h2>Deviance</h2>
<p>The null and residual deviance that we see in the model output can be calculated as:</p>
<p><span class="math display">\[
D_{\mbox{null}} = 2 -(log(\mathcal{L}_{\mbox{null}}) - log(\mathcal{L}_{\mbox{sat}}))
\]</span> <span class="math display">\[
D_{\mbox{resid}} = 2 -(log(\mathcal{L}_{\mbox{current}}) - log(\mathcal{L}_{\mbox{sat}}))
\]</span></p>
</section>
<section id="deviance-3" class="slide level2">
<h2>Deviance</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat))</span>
<span id="cb121-2"><a aria-hidden="true" tabindex="-1"></a>fit_cur <span class="ot">&lt;-</span> fit_int <span class="co"># current model</span></span>
<span id="cb121-3"><a aria-hidden="true" tabindex="-1"></a>fit_sat <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> id, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb121-4"><a aria-hidden="true" tabindex="-1"></a>fit_null <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># residual</span></span>
<span id="cb122-2"><a aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="sc">-</span>(<span class="fu">logLik</span>(fit_cur) <span class="sc">-</span> <span class="fu">logLik</span>(fit_sat))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' 447.0538 (df=2)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># null</span></span>
<span id="cb124-2"><a aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="sc">-</span>(<span class="fu">logLik</span>(fit_null) <span class="sc">-</span> <span class="fu">logLik</span>(fit_sat))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' 512.8316 (df=1)</code></pre>
</div>
</div>
</section>
<section id="deviance-lrt" class="slide level2">
<h2>Deviance, LRT</h2>

<img data-src="img/lrt.svg" class="r-stretch"></section>
<section id="r2" class="slide level2">
<h2><span class="math inline">\(R^2\)</span></h2>
<p>The <span class="math inline">\(R^2\)</span> cannot be computed as in standard linear regression. There are different types of pseudo-<span class="math inline">\(R^2\)</span> for example:</p>
<ul>
<li>Likelihood ratio <span class="math inline">\(R^2_L\)</span></li>
<li>Cox and Snell <span class="math inline">\(R^2_{CS}\)</span></li>
<li>Nagelkerke <span class="math inline">\(R^2_N\)</span></li>
<li>McFadden <span class="math inline">\(R^2_{McF}\)</span></li>
<li>Tjur <span class="math inline">\(R^2_T\)</span></li>
</ul>
<p>All these methods are based on the deviance and/or the likelihood of current/null/saturated models.</p>

<aside><div>
<p>See <a href="https://en.wikipedia.org/wiki/Pseudo-R-squared">https://en.wikipedia.org/wiki/Pseudo-R-squared</a> for a nice overview.</p>
</div></aside></section>
<section id="r2-1" class="slide level2">
<h2><span class="math inline">\(R^2\)</span></h2>
<p>The <code>performance</code> R package (used to plot diagnostics and other modelling-related metrics) implements most of the pseudo-<span class="math inline">\(R^2\)</span> values. The default for binomial models is the method proposed by <span class="citation" data-cites="Tjur2009-ml">Tjur (<a href="#/references" role="doc-biblioref" onclick="">2009</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># performance::r2_tjur()</span></span>
<span id="cb126-2"><a aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2</span>(fit_emo_x_int2) </span>
<span id="cb126-3"><a aria-hidden="true" tabindex="-1"></a><span class="do">## # R2 for Logistic Regression</span></span>
<span id="cb126-4"><a aria-hidden="true" tabindex="-1"></a><span class="do">##   Tjur's R2: 0.578</span></span>
<span id="cb126-5"><a aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2_coxsnell</span>(fit_emo_x_int2)</span>
<span id="cb126-6"><a aria-hidden="true" tabindex="-1"></a><span class="do">## Cox &amp; Snell's R2 </span></span>
<span id="cb126-7"><a aria-hidden="true" tabindex="-1"></a><span class="do">##        0.5030847</span></span>
<span id="cb126-8"><a aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2_mcfadden</span>(fit_emo_x_int2)</span>
<span id="cb126-9"><a aria-hidden="true" tabindex="-1"></a><span class="do">## # R2 for Generalized Linear Regression</span></span>
<span id="cb126-10"><a aria-hidden="true" tabindex="-1"></a><span class="do">##        R2: 0.545</span></span>
<span id="cb126-11"><a aria-hidden="true" tabindex="-1"></a><span class="do">##   adj. R2: 0.530</span></span>
<span id="cb126-12"><a aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2_nagelkerke</span>(fit_emo_x_int2)</span>
<span id="cb126-13"><a aria-hidden="true" tabindex="-1"></a><span class="do">## Nagelkerke's R2 </span></span>
<span id="cb126-14"><a aria-hidden="true" tabindex="-1"></a><span class="do">##       0.6962745</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="residuals" class="slide level2">
<h2>Residuals</h2>
<p>Diagnostics in GLMs is more complex than in standard linear models. The main reason is that residuals are more complex due to the link function. For example these are the residuals of the last model we fitted.</p>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-69-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="residuals-1" class="slide level2">
<h2>Residuals</h2>
<p>There are few problems with residuals in GLM:</p>
<ul>
<li><strong>Mean and variance are linked</strong>. This means that as the mean increase also the variance increase violating the standard homoschedasticity assumption. This mainly happens with standard <em>raw</em> residuals and in GLM we need to use other residuals (e.g., Pearson, Deviance, etc.)</li>
<li><strong>Residuals (even the Pearson or Deviance) are problematic for <em>discrete</em> GLM</strong> (such as Binomial or Poisson), see the plot in the previous slide.</li>
<li><strong>Residuals for non-normal distributions are not expected to be normally distributed</strong> even when the model is well specified.</li>
<li><strong>There are no standard and universal way</strong> to assess the residuals pattern.</li>
</ul>
</section>
<section id="residuals-a-proposal" class="slide level2">
<h2>Residuals, a proposal</h2>
<blockquote>
<p>The <code>DHARMa</code> package uses a simulation-based approach to create readily interpretable scaled (quantile) residuals for fitted generalized linear (mixed) models</p>
</blockquote>
<p>These residuals seems quite promising as an unified framework but I haven’t systematically explored this possibility.</p>
<p>The <code>DHARMa</code> package has a nice <a href="https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html">documentation</a> explaining the idea and how to use the quantile residuals <span class="citation" data-cites="Dunn1996-yd Dunn2018-ww">(see also <a href="#/references" role="doc-biblioref" onclick="">Dunn &amp; Smyth, 1996</a>, <a href="#/references" role="doc-biblioref" onclick="">2018</a>)</span>.</p>
</section>
<section id="residuals-a-proposal-1" class="slide level2">
<h2>Residuals, a proposal</h2>
<blockquote>
<p>The resulting residuals are standardized to values between 0 and 1 and can be interpreted as intuitively as residuals from a linear regression.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb127-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">simulateResiduals</span>(fit_emo_x_int2))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

</section><section id="residuals-a-proposal-1-output" class="slide level2 output-location-slide"><h2>Residuals, a proposal</h2><div class="cell output-location-slide" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-70-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div></section></section>
<section>
<section id="monte-carlo-simulations-mcs" class="title-slide slide level1 center">
<h1>Monte Carlo simulations (MCS)</h1>

</section>
<section id="why-simulating-data" class="slide level2">
<h2>Why simulating data?</h2>
<p>If you plan to use a GLM and you want to compute some inferential properties (statistical power, type-1 error, etc.) there are usually no analytical (i.e., formula-based) methods to solve the problem.</p>
<p>The only way to do a power analysis with a logistic regression is to simulate data and re-fit the model multiple times to see the long-run behaviour.</p>
<p>MCS are also useful to understand more deeply a certain statistical model or procedure.</p>
</section>
<section id="general-mcs-workflow" class="slide level2">
<h2>General MCS workflow</h2>
<ol type="1">
<li>Define the Data Generation Process (DGP)</li>
<li>Define the sample size, number of trials, conditions, etc.</li>
<li>Simulate data using random number generations and the DGP</li>
<li>Fit the target model</li>
<li>Repeat 3-4 a large number of times maybe with different features (e.g., different sample size) defined in 2</li>
<li>Summarise the simulation results. For example, counting the number of times the p value is significant (i.e., estimating the statistical power)</li>
</ol>

<aside><div>
<p>We have also a longer <a href="https://filippogambarota.github.io/notes/mcs-workflow/">document</a> about implementing a MCS in R.</p>
</div></aside></section>
<section id="data-generation-process-dgp" class="slide level2">
<h2>1. Data Generation Process (DGP)</h2>
<p>Let’s try estimating the statistical power for the <code>intensity</code> effect in our example.</p>
<p>We will simulate data according to a Binomial GLM with a logit link function.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb128-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">qlogis</span>() <span class="co"># link function</span></span>
<span id="cb128-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>() <span class="co"># inverse link function</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="experiment-features" class="slide level2">
<h2>2. Experiment features</h2>
<p>We will simulate a single subject doing <span class="math inline">\(n\)</span> trials. The main predictor is <code>intensity</code> ranging from 10% to 100% in steps of 10%.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a aria-hidden="true" tabindex="-1"></a>(intensity <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  10  20  30  40  50  60  70  80  90 100</code></pre>
</div>
</div>
</section>
<section id="random-number-generation" class="slide level2">
<h2>3. Random number generation</h2>
<p>In R, to simulate data you can use the <code>r*</code> function. Each implemented distribution in R has the associated <code>r*</code> function (as the <code>p*</code> and <code>q*</code> function we used before).</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># simulate 10 numbers from a gaussian distribution</span></span>
<span id="cb131-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># with mu = 10 and sigma = 5</span></span>
<span id="cb131-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0.5383932 10.9113661  4.4995351  9.5580316 12.7771419 12.4440070
 [7] 12.2122934  9.3329124  6.1627081 15.3577288</code></pre>
</div>
</div>
</section>
<section id="random-number-generation-1" class="slide level2">
<h2>3. Random number generation</h2>
<p>For the Binomial we have <code>rbinom</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># n = number of rows in our case</span></span>
<span id="cb133-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># size = number of trials</span></span>
<span id="cb133-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># p = probability of success in each trial</span></span>
<span id="cb133-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 0 0 1 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 6 6 3 5</code></pre>
</div>
</div>
</section>
<section id="random-number-generation-2" class="slide level2">
<h2>3. Random number generation</h2>
<p>Notice that <code>rbinom</code> is not really intutive because it works both on the binary and the binomial form.</p>
<p>This means to generate <span class="math inline">\(k\)</span> bernoulli trials with results 0 or 1</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 0 1 1 1 1 1 1 1</code></pre>
</div>
</div>
<p>This is the same but aggregating:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># the result is the number of successes over 10 </span></span>
<span id="cb141-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># bernoulli trials</span></span>
<span id="cb141-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>Depending if you want to work with 0-1 values or number of successes/failures (aggregated) you should use one of the two strategies.</p>
</section>
<section id="random-number-generation-3" class="slide level2">
<h2>3. Random number generation</h2>
<p>The crucial part of <code>rbinom</code> is that the <code>prob =</code> argument is vectorized. This means that if you simulate <span class="math inline">\(n\)</span> trials you can provide <span class="math inline">\(n\)</span> probabilities.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># 20 different probabilities</span></span>
<span id="cb143-2"><a aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">length.out =</span> <span class="dv">20</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.1000000 0.1421053 0.1842105 0.2263158 0.2684211 0.3105263 0.3526316
 [8] 0.3947368 0.4368421 0.4789474 0.5210526 0.5631579 0.6052632 0.6473684
[15] 0.6894737 0.7315789 0.7736842 0.8157895 0.8578947 0.9000000</code></pre>
</div>
</div>
<p>This means that for the last trials, the probability of success (1) is larger.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0 0 1 1 1 1 0 0 0 0 0 0 1 1 1 0 0 0 1 0</code></pre>
</div>
</div>
</section>
<section id="dataset" class="slide level2">
<h2>Dataset</h2>
<p>We can start with the deterministic part of the simulation, the experiment.</p>
<p>We simulate an experiment with <code>nt</code> trials with random <code>intensity</code> values from 10 to 100. We could also create a balanced version.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of trials</span></span>
<span id="cb147-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb147-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="at">intensity =</span> <span class="fu">sample</span>(intensity, nt, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb147-5"><a aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb147-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat) <span class="co"># first 6 rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  intensity
1        40
2        40
3        50
4        10
5        50
6       100</code></pre>
</div>
</div>
</section>
<section id="systematic-component-and-random-component" class="slide level2">
<h2>Systematic component and random component</h2>
<p>The model can be formalized as:</p>
<p><span class="math display">\[
p_i = g^{-1}(\beta_0 + \beta_1 \times \mbox{intensity}_i)
\]</span></p>
<p><span class="math display">\[
y_i \sim \mathrm{Bernoulli}(p_i) \qquad y_i \in \{0,1\}
\]</span></p>
<p>Where <span class="math inline">\(g^{-1}\)</span> is the inverse logit function (<code>qlogis</code>). This can be reas as, for each trial <span class="math inline">\(i\)</span> the true probability of success is a function of the <code>intensity</code>-<span class="math inline">\(i\)</span>. The 0-1 outcome comes from a Bernoulli distribution with probability of success <span class="math inline">\(p_i\)</span>. This means that according to <span class="math inline">\(\beta_1\)</span> different intensity values will have a different probability of success.</p>
<p>Finally <span class="math inline">\(\beta_0 + \beta_1 \times \mbox{intensity}_i\)</span> (i.e., the linear predictor <span class="math inline">\(\eta_i\)</span>) need to be simulated in logit scale, then converted back into probabilities.</p>
</section>
<section id="systematic-component-and-random-component-1" class="slide level2">
<h2>Systematic component and random component</h2>
<p><span class="math inline">\(\beta_0\)</span> is the (logit) probability of success for intensity 10%, centering the <code>intensity</code> on the minimum. <span class="math inline">\(\beta_1\)</span> is the increase in logit for a unit increase in intensity. Let’s rescale intensity to be between 0 (10%) and 10 (100%).</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(<span class="fl">0.1</span>) <span class="co"># logit of success when intensity = 10%</span></span>
<span id="cb149-2"><a aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb149-3"><a aria-hidden="true" tabindex="-1"></a>intensity10 <span class="ot">&lt;-</span> (intensity <span class="sc">-</span> <span class="dv">10</span>) <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb149-4"><a aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> intensity10</span>
<span id="cb149-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-6"><a aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb149-7"><a aria-hidden="true" tabindex="-1"></a>  intensity,</span>
<span id="cb149-8"><a aria-hidden="true" tabindex="-1"></a>  eta</span>
<span id="cb149-9"><a aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb149-10"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> intensity, <span class="at">y =</span> <span class="fu">plogis</span>(eta))) <span class="sc">+</span></span>
<span id="cb149-11"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb149-12"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb149-13"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Intensity"</span>) <span class="sc">+</span></span>
<span id="cb149-14"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Accuracy"</span>) <span class="sc">+</span></span>
<span id="cb149-15"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta_1 = 1$"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>

</section>
<section id="systematic-component-and-random-component-1-output" class="slide level2 output-location-slide"><h2>Systematic component and random component</h2><div class="cell output-location-slide" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-80-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div></section><section id="systematic-component-and-random-component-2" class="slide level2">
<h2>Systematic component and random component</h2>
<p>You can choose different <span class="math inline">\(\beta_1\)</span> values according to your hypothesis.</p>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-81-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="systematic-component-and-random-component-3" class="slide level2">
<h2>Systematic component and random component</h2>
<p>Now we can simply apply the same functions to the full dataset. Let’s stick with <span class="math inline">\(\beta_1 = 0.5\)</span> for the moment.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(<span class="fl">0.1</span>)</span>
<span id="cb150-2"><a aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb150-3"><a aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>intensity10 <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, (intensity <span class="sc">-</span> <span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb150-4"><a aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>eta <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, b0 <span class="sc">+</span> b1 <span class="sc">*</span> intensity10) <span class="co"># link function space</span></span>
<span id="cb150-5"><a aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">plogis</span>(dat<span class="sc">$</span>eta) <span class="co"># inverse link (probability)</span></span>
<span id="cb150-6"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  intensity intensity10        eta         p
1        40           3  0.8027754 0.6905679
2        40           3  0.8027754 0.6905679
3        50           4  1.8027754 0.8584864
4        10           0 -2.1972246 0.1000000
5        50           4  1.8027754 0.8584864
6       100           9  6.8027754 0.9988905</code></pre>
</div>
</div>
</section>
<section id="simulate-the-0-1-response" class="slide level2">
<h2>Simulate the 0-1 response</h2>
<p>Finally we need to simulate the 0-1 response for each trial/observation:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>acc <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">nrow</span>(dat), <span class="dv">1</span>, dat<span class="sc">$</span>p)</span>
<span id="cb152-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  intensity intensity10        eta         p acc
1        40           3  0.8027754 0.6905679   0
2        40           3  0.8027754 0.6905679   1
3        50           4  1.8027754 0.8584864   0
4        10           0 -2.1972246 0.1000000   0
5        50           4  1.8027754 0.8584864   1
6       100           9  6.8027754 0.9988905   1</code></pre>
</div>
</div>
<p>For each row/trial, <code>p</code> is the true accuracy according to <code>intensity</code> and <code>acc</code> is the actual simulated response.</p>
</section>
<section id="simulate-the-0-1-response-1" class="slide level2">
<h2>Simulate the 0-1 response</h2>
<p>Always plot your simulated data to check the results:</p>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-84-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="fit-the-target-model" class="slide level2">
<h2>4. Fit the target model</h2>
<p>Now we can fit the desired model:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> intensity10, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb154-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = acc ~ intensity10, family = binomial(link = "logit"), 
    data = dat)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -1.9988     0.5722  -3.493 0.000477 ***
intensity10   0.9347     0.1969   4.747 2.06e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 118.59  on 99  degrees of freedom
Residual deviance:  58.62  on 98  degrees of freedom
AIC: 62.62

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
</section>
<section id="repeat-the-process" class="slide level2">
<h2>5. Repeat the process</h2>
<p>Now the core of MCS. By repeating the data generation and model fitting we are simulating the randomness that could happen in real data collection. Better wrapping everything into a function:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="cf">function</span>(nt, b0, b1){</span>
<span id="cb156-2"><a aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb156-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">intensity =</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">10</span>), nt, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb156-4"><a aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb156-5"><a aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>intensity10 <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, (intensity <span class="sc">-</span> <span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb156-6"><a aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>eta <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, b0 <span class="sc">+</span> b1 <span class="sc">*</span> intensity10)</span>
<span id="cb156-7"><a aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">plogis</span>(dat<span class="sc">$</span>eta)</span>
<span id="cb156-8"><a aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>acc <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">nrow</span>(dat), <span class="dv">1</span>, dat<span class="sc">$</span>p)</span>
<span id="cb156-9"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dat)</span>
<span id="cb156-10"><a aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb156-11"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-12"><a aria-hidden="true" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb156-13"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(acc <span class="sc">~</span> intensity10, <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb156-14"><a aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb156-15"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-16"><a aria-hidden="true" tabindex="-1"></a>summary_model <span class="ot">&lt;-</span> <span class="cf">function</span>(fit){</span>
<span id="cb156-17"><a aria-hidden="true" tabindex="-1"></a>  <span class="co"># keep only intensity coefficients</span></span>
<span id="cb156-18"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">summary</span>(fit)<span class="sc">$</span>coefficients)[<span class="dv">2</span>, ]</span>
<span id="cb156-19"><a aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="repeat-the-process-1" class="slide level2">
<h2>5. Repeat the process</h2>
<p>And a overall simulation function:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a aria-hidden="true" tabindex="-1"></a>do_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(nsim, nt, b0, b1){</span>
<span id="cb157-2"><a aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">replicate</span>(nsim, {</span>
<span id="cb157-3"><a aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">sim_data</span>(nt, b0, b1)</span>
<span id="cb157-4"><a aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(dat)</span>
<span id="cb157-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary_model</span>(fit)</span>
<span id="cb157-6"><a aria-hidden="true" tabindex="-1"></a>  }, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb157-7"><a aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, res)</span>
<span id="cb157-8"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(res) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb157-9"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"se"</span>, <span class="st">"z"</span>, <span class="st">"p"</span>)</span>
<span id="cb157-10"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb157-11"><a aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-12"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-13"><a aria-hidden="true" tabindex="-1"></a><span class="fu">do_sim</span>(<span class="dv">5</span>, <span class="dv">100</span>, b0, b1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          b        se        z            p
1 1.1878385 0.2484520 4.780958 1.744619e-06
2 1.4235879 0.3191330 4.460798 8.165498e-06
3 1.9570631 0.4753204 4.117356 3.832445e-05
4 1.2834451 0.3208077 4.000668 6.316380e-05
5 0.8576472 0.1820976 4.709821 2.479343e-06</code></pre>
</div>
</div>
</section>
<section id="repeat-the-process-2" class="slide level2">
<h2>5. Repeat the process</h2>
<p><code>nsim</code> is the number of simulations. Usually larger is better considering computational constraints. If feasible, 5000 or 10000 is usually more than enough. For complex models where 5000 or 10000 is not an option, try never go below 1000. See <span class="citation" data-cites="Burton2006-hl">Burton et al. (<a href="#/references" role="doc-biblioref" onclick="">2006</a>)</span> and <span class="citation" data-cites="Koehler2009-do">Koehler et al. (<a href="#/references" role="doc-biblioref" onclick="">2009</a>)</span> for discussion about the number of simulations.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb159-2"><a aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">do_sim</span>(<span class="dv">1000</span>, <span class="at">nt =</span> <span class="dv">50</span>, <span class="at">b0 =</span> <span class="fu">qlogis</span>(<span class="fl">0.1</span>), <span class="at">b1 =</span> <span class="fl">0.5</span>)</span>
<span id="cb159-3"><a aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.404 sec elapsed</code></pre>
</div>
</div>
<p>In this case we are lucky, running 1000 simulations only takes ~ 1.5 seconds. Sometimes can also takes hours, days or weeks.</p>
</section>
<section id="results" class="slide level2">
<h2>6. Results</h2>
<p>Each row is the parameter estimated from a simulated dataset. The statistical power is the % of p values lower than <span class="math inline">\(\alpha\)</span> of the total number of simulations:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          b        se        z            p
1 1.5410786 0.4852222 3.176027 0.0014930715
2 0.3764563 0.1198587 3.140833 0.0016846805
3 0.3810226 0.1310121 2.908301 0.0036339844
4 0.5209755 0.1500228 3.472643 0.0005153596
5 0.5370749 0.1589363 3.379184 0.0007270144
6 0.5244714 0.1468180 3.572255 0.0003539202</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(sim<span class="sc">$</span>p <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="dv">1000</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.994</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># or mean(sum(sim$p &lt;= 0.05))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The power is pretty high with 50 trials. Let’s try a lower effect with different number of trials.</p>
</section>
<section id="more-conditions" class="slide level2">
<h2>More conditions</h2>
<p>We can try different number of trials. For each <code>n</code> we simulate 1000 datasets, fit the models, extract the p values and estimate the statistical power.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">80</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>)</span>
<span id="cb166-2"><a aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(n))</span>
<span id="cb166-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-4"><a aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(power)){</span>
<span id="cb166-5"><a aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">do_sim</span>(<span class="dv">1000</span>, n[i], <span class="at">b0 =</span> <span class="fu">qlogis</span>(<span class="fl">0.1</span>), <span class="at">b1 =</span> <span class="fl">0.2</span>)</span>
<span id="cb166-6"><a aria-hidden="true" tabindex="-1"></a>  power[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(res<span class="sc">$</span>p <span class="sc">&lt;=</span> <span class="fl">0.05</span>)</span>
<span id="cb166-7"><a aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb166-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-9"><a aria-hidden="true" tabindex="-1"></a>power</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000 0.362 0.520 0.603 0.820 0.912</code></pre>
</div>
</div>
</section>
<section id="more-conditions-1" class="slide level2">
<h2>More conditions</h2>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-91-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section></section>
<section>
<section id="latent-formulation-of-the-binomial-model" class="title-slide slide level1 center">
<h1>Latent formulation of the binomial model</h1>

</section>
<section id="latent-formulation-of-the-binomial-model-1" class="slide level2">
<h2>Latent formulation of the binomial model</h2>
<p>To clarify a little bit the terminology the <em>logit</em> function (link function <span class="math inline">\(g(\cdot)\)</span>) is:</p>
<p><span class="math display">\[
q = \log{\frac{p}{1 - p}}
\]</span></p>
<p>The inverse of the logit is called <em>logistic</em> (inverse link function <span class="math inline">\(g^{-1}(\cdot)\)</span>) function:</p>
<p><span class="math display">\[
p = \frac{e^p}{1 + e^p}
\]</span></p>
</section>
<section id="latent-formulation-of-the-binomial-model-2" class="slide level2">
<h2>Latent formulation of the binomial model</h2>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-92-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="latent-formulation-of-the-binomial-model-3" class="slide level2">
<h2>Latent formulation of the binomial model</h2>
<ul>
<li>Instead of thinking about a binary variable, you can think about e.g.&nbsp;accuracy as a continous measure from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(+\infty\)</span>.</li>
<li>Then you can imagine to cut this continous measure using a threshold. Everthing above the threshold takes the value 1 otherwise 0.</li>
<li>Using the <em>logit</em> function we are assuming that this underlying <em>latent</em> variable is a standard <strong>logistic</strong> distribution.</li>
<li>The standard logistic distribution is a continous variable (similar to the Gaussian) with mean <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma^2 = \frac{s^2 \pi^2}{3}\)</span>. Given that <span class="math inline">\(s^2 = 1\)</span> in the standard logistic distribution the variance is <span class="math inline">\(\frac{\pi^2}{3}\)</span>.</li>
</ul>

<aside><div>
<p><a href="https://en.wikipedia.org/wiki/Logistic_distribution">https://en.wikipedia.org/wiki/Logistic_distribution</a></p>
</div></aside></section>
<section id="latent-formulation-of-the-binomial-model-4" class="slide level2">
<h2>Latent formulation of the binomial model</h2>
<p>You can draw the logistic distribution using <code>dlogis()</code>. The comulative distribution function <code>plogis()</code> is the <em>logistic</em> function and the quantile function <code>qlogis()</code> is the <em>logit</em> function.</p>
</section>
<section id="latent-formulation-of-the-binomial-model-5" class="slide level2">
<h2>Latent formulation of the binomial model</h2>
<p>In this framework, saying that the logit in one condition is 0 means that the probability is 0.5 thus 50% of the observations are expected to have a value of 1 and 50% a value of 0.</p>
<p>A shift in the latent distribution represents also a shift in the proportions of 1 and 0. Regression coefficients (in logit) represent the shift in the latent distribution and odds ratios are the shift in the odds/proportions.</p>
</section>
<section id="latent-formulation-of-the-binomial-model-6" class="slide level2">
<h2>Latent formulation of the binomial model</h2>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-93-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="latent-formulation-of-the-binomial-model-7" class="slide level2">
<h2>Latent formulation of the binomial model</h2>
<p>In other terms, the logistic regression can be expressed as a linear model predicting shifts in the mean of the logistic distribution as a functions of predictors as in standard linear models assuming normality.</p>
<p>The parameters <span class="math inline">\(\beta\)</span> are shifts in the underlying latent distribution. <span class="math inline">\(\beta = 1\)</span> is like saying that the difference between the groups is 1 standard deviation on the latent scale.</p>
</section>
<section id="latent-formulation-of-the-binomial-model-8" class="slide level2">
<h2>Latent formulation of the binomial model</h2>
<p>Practically this means that we can write the same model in the latent form:</p>
<p><span class="math display">\[
z_i = \beta_0 + \beta_1 x_i + \epsilon_i
\]</span></p>
<p><span class="math display">\[
\epsilon_i \sim \mbox{Logistic}(0, 1)
\]</span></p>
<p>Where <span class="math inline">\(z_i\)</span> is the latent value (e.g., logit). Errors are distributed according to a standard logistic distribution.</p>
<p>Then the observed 0-1 values:</p>
<p><span class="math display">\[
\begin{cases}
1 &amp; \text{if } z_i &gt; 0, \\
0 &amp; \text{if } z_i \le 0 .
\end{cases}
\]</span></p>
</section>
<section id="latent-formulation-of-the-binomial-model-9" class="slide level2">
<h2>Latent formulation of the binomial model</h2>
<p>In R we can show this very easily. We can simulate a latent shift and the corresponding pattern in probabilities using the standard and latent form of the logistic regression.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># probability of group 1</span></span>
<span id="cb168-2"><a aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="co"># probability of group 2</span></span>
<span id="cb168-3"><a aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(p2) <span class="sc">-</span> <span class="fu">qlogis</span>(p1)) <span class="co"># latent shift, log odds ratio</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.386294</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a aria-hidden="true" tabindex="-1"></a>(OR <span class="ot">&lt;-</span> <span class="fu">exp</span>(d)) <span class="co"># odds ratio</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</section>
<section id="latent-formulation-of-the-binomial-model-10" class="slide level2">
<h2>Latent formulation of the binomial model</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations, large to show the pattern</span></span>
<span id="cb172-2"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb172-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># using rbinom</span></span>
<span id="cb172-5"><a aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> n<span class="sc">/</span><span class="dv">2</span>) <span class="co"># condition 1 and condition 2</span></span>
<span id="cb172-6"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="fu">qlogis</span>(p1) <span class="sc">+</span> d <span class="sc">*</span> x)</span>
<span id="cb172-7"><a aria-hidden="true" tabindex="-1"></a>yb <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p)</span>
<span id="cb172-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># latent form</span></span>
<span id="cb172-10"><a aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(p1) <span class="sc">+</span> x <span class="sc">*</span> d <span class="sc">+</span> <span class="fu">rlogis</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb172-11"><a aria-hidden="true" tabindex="-1"></a>yl <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(z <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb172-12"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-13"><a aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(yb, x, mean)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     0      1 
0.5022 0.7974 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(yl, x, mean)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     0      1 
0.5006 0.8058 </code></pre>
</div>
</div>
</section>
<section id="latent-formulation-of-the-binomial-model-11" class="slide level2">
<h2>Latent formulation of the binomial model</h2>
<p>The beauty of the latent intepretation is that if you change the error part from a logistic to a gaussian distribution, you obtain the <strong>probit</strong> model.</p>
<p>In the probit the idea is the same but shifts are in units of a standard normal distribution that can be intepreted as Cohen’s <span class="math inline">\(d\)</span>.</p>
</section></section>
<section>
<section id="probit-link-function" class="title-slide slide level1 center">
<h1>Probit link function</h1>

</section>
<section id="probit-link-function-1" class="slide level2">
<h2>Probit link function</h2>
<p>Sometimes, the <em>probit</em> link function can be used. The main difference is that when using the <em>logit</em> link function the underlying distribution is called logistic. When using the <em>probit</em> link function the underlying distribution is Gaussian.</p>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-96-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="probit-link-function-2" class="slide level2">
<h2>Probit link function</h2>
<p>When using the <strong>probit link</strong> the parameters are interpreted as difference in <em>z-scores</em> associated with a unit increase in the predictors. In fact probabilities are mapped into <em>z-scores</em> using the cumulative normal distribution.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb176-2"><a aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb176-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">qlogis</span>(<span class="fu">c</span>(p1, p2)) <span class="co"># log(odds(p1)), logit link</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.3862944 0.4054651</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(p1, p2)) <span class="co"># probit link</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8416212 0.2533471</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">or</span>(p1, p2)) <span class="co"># ~ beta1, logit link</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9808293</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(p1) <span class="sc">-</span> <span class="fu">qnorm</span>(p2) <span class="co"># ~beta1, probit link</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5882741</code></pre>
</div>
</div>
</section>
<section id="probit-link-function-3" class="slide level2">
<h2>Probit link function</h2>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-98-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="why-using-the-probit-link-function" class="slide level2">
<h2>Why using the probit link function?</h2>
<p>The probit can be a really useful choice:</p>
<ul>
<li>A binomial GLM with a probit link can be used to estimate Signal Detection Theory (<span class="math inline">\(d\)</span>’ and criterion) parameters <span class="citation" data-cites="DeCarlo1998-ay DeCarlo2010-lj">(see <a href="#/references" role="doc-biblioref" onclick="">DeCarlo, 1998</a>, <a href="#/references" role="doc-biblioref" onclick="">2010</a>)</span>.</li>
<li>The parameters are intepreted as differences in standard deviations similar to Cohen’s <span class="math inline">\(d\)</span>. This is also very useful in simulations.</li>
</ul>
</section></section>
<section>
<section id="odds-ratio-or-to-cohens-d" class="title-slide slide level1 center">
<h1>Odds Ratio (OR) to Cohen’s <span class="math inline">\(d\)</span></h1>

</section>
<section id="odds-ratio-or-to-cohens-d-1" class="slide level2">
<h2>Odds Ratio (OR) to Cohen’s <span class="math inline">\(d\)</span></h2>
<p>The Odds Ratio can be considered an effect size measure. We can transform the OR into other effect size measure <span class="citation" data-cites="Sanchez-Meca2003-ji Borenstein2009-mo">(<a href="#/references" role="doc-biblioref" onclick="">Borenstein et al., 2009</a>; <a href="#/references" role="doc-biblioref" onclick="">Sánchez-Meca et al., 2003</a>)</span>.</p>
<p><span class="math display">\[
d = \log(OR) \frac{\sqrt{3}}{\pi}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># in R with the effectsize package</span></span>
<span id="cb184-2"><a aria-hidden="true" tabindex="-1"></a>or <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb184-3"><a aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">logoddsratio_to_d</span>(<span class="fu">log</span>(or))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2235446</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># or </span></span>
<span id="cb186-2"><a aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">oddsratio_to_d</span>(or)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2235446</code></pre>
</div>
</div>
</section>
<section id="odds-ratio-or-to-cohens-d-2" class="slide level2">
<h2>Odds Ratio (OR) to Cohen’s <span class="math inline">\(d\)</span></h2>

<img data-src="binomial-glm_files/figure-revealjs/unnamed-chunk-100-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section></section>
<section>
<section id="binary-vs-binomial-data-structure" class="title-slide slide level1 center">
<h1>Binary vs binomial data structure</h1>

</section>
<section id="binary-vs-binomial-data-structure-1" class="slide level2">
<h2>Binary vs binomial data structure</h2>
<p>In our facial expression example we used the binary data structure. This means that the vector of the response variable contains 0 and 1.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
     id age   intensity emotion_lbl response_lbl   acc
  &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;        &lt;int&gt;
1    22 53           60 fear        suprise          0
2    22 53           60 disgust     disgust          1
3    22 53           70 happiness   happiness        1
4    22 53          100 happiness   happiness        1
5    22 53           60 disgust     sadness          0
6    22 53           20 fear        neutral          0</code></pre>
</div>
</div>
</section>
<section id="binary-vs-binomial-data-structure-2" class="slide level2">
<h2>Binary vs binomial data structure</h2>
<p>The same dataset can be also used in the so-called binomial format. In this case we can aggregate <code>emotion_lbl</code> and <code>intensity</code> counting the number of correct responses.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a aria-hidden="true" tabindex="-1"></a>dat_binomial <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb190-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(intensity) <span class="sc">|&gt;</span> </span>
<span id="cb190-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nt =</span> <span class="fu">n</span>(),      <span class="co"># total number of trials</span></span>
<span id="cb190-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">nc =</span> <span class="fu">sum</span>(acc), <span class="co"># number of correct responses</span></span>
<span id="cb190-5"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">nf =</span> nt <span class="sc">-</span> nc,  <span class="co"># number of fails</span></span>
<span id="cb190-6"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">acc =</span> nc <span class="sc">/</span> nt) <span class="co"># proportion of correct response</span></span>
<span id="cb190-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat_binomial)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  intensity    nt    nc    nf    acc
      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
1        10    37     3    34 0.0811
2        20    37     3    34 0.0811
3        30    37    12    25 0.324 
4        40    37    18    19 0.486 
5        50    37    23    14 0.622 
6        60    37    23    14 0.622 </code></pre>
</div>
</div>
</section>
<section id="binary-vs-binomial-data-structure-3" class="slide level2">
<h2>Binary vs binomial data structure</h2>
<p>The dataset contains <strong>exactly</strong> the same information, we are not losing anything by aggregating. We can check it by fitting two models. Notice the way of writing the model in the binomial way:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a aria-hidden="true" tabindex="-1"></a>fit_binary   <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> intensity, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb192-2"><a aria-hidden="true" tabindex="-1"></a>fit_binomial <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(nc, nf) <span class="sc">~</span> intensity, <span class="at">data =</span> dat_binomial, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb192-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">compareCoefs</span>(fit_binary, fit_binomial)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calls:
1: glm(formula = acc ~ intensity, family = binomial(link = "logit"), data = 
  dat)
2: glm(formula = cbind(nc, nf) ~ intensity, family = binomial(link = 
  "logit"), data = dat_binomial)

            Model 1 Model 2
(Intercept)  -1.798  -1.798
SE            0.264   0.264
                           
intensity   0.03198 0.03198
SE          0.00429 0.00429
                           </code></pre>
</div>
</div>
</section>
<section id="binary-vs-binomial-data-structure-4" class="slide level2">
<h2>Binary vs binomial data structure</h2>
<p>A third option is also modelling directly the proportions providing the <code>weigths =</code> argument as the number of trials.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a aria-hidden="true" tabindex="-1"></a>fit_prop <span class="ot">&lt;-</span> <span class="fu">glm</span>(acc <span class="sc">~</span> intensity, <span class="at">data =</span> dat_binomial, <span class="at">weights =</span> nt, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)) </span>
<span id="cb194-2"><a aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">compareCoefs</span>(fit_binary, fit_binomial, fit_prop)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Calls:
1: glm(formula = acc ~ intensity, family = binomial(link = "logit"), data = 
  dat)
2: glm(formula = cbind(nc, nf) ~ intensity, family = binomial(link = 
  "logit"), data = dat_binomial)
3: glm(formula = acc ~ intensity, family = binomial(link = "logit"), data = 
  dat_binomial, weights = nt)

            Model 1 Model 2 Model 3
(Intercept)  -1.798  -1.798  -1.798
SE            0.264   0.264   0.264
                                   
intensity   0.03198 0.03198 0.03198
SE          0.00429 0.00429 0.00429
                                   </code></pre>
</div>
</div>
<p>Again, exactly the same.</p>
</section>
<section id="binary-vs-binomial-data-structure-5" class="slide level2">
<h2>Binary vs binomial data structure</h2>
<p>Why using the binary vs the binomial format? Depends on the type of predictors!</p>
<p>In our (and similar) case, “aggregating” with categorical predictor is possible without losing information. The advantage is that models in the binomial format are very fast (especially for complex models such as mixed-effects models). Also the diagnostics in terms of residuals are better <span class="citation" data-cites="Gelman2020-tg">(see <a href="#/references" role="doc-biblioref" onclick="">Gelman et al., 2020, p. 253</a>)</span></p>
<p>If you have predictors at the 0-1 level you cannot aggregate without losing information. In our case, imagine to have for each trial the 0-1 accuracy and the reaction time. You need to use the binary format otherwise you have to bin the reaction time variable (losing information).</p>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Arel-Bundock2024-zl" class="csl-entry" role="listitem">
Arel-Bundock, V., Greifer, N., &amp; Heiss, A. (2024). <span class="nocase">How to Interpret Statistical Models Using marginaleffects for <em>R</em> and <em>Python</em></span>. <em>Journal of Statistical Software</em>, <em>111</em>, 1–32. <a href="https://doi.org/10.18637/jss.v111.i09">https://doi.org/10.18637/jss.v111.i09</a>
</div>
<div id="ref-Borenstein2009-mo" class="csl-entry" role="listitem">
Borenstein, M., Hedges, L. V., Higgins, J. P. T., &amp; Rothstein, H. R. (2009). <em><span class="nocase">Introduction to <span>Meta-Analysis</span></span></em>. <a href="https://doi.org/10.1002/9780470743386">https://doi.org/10.1002/9780470743386</a>
</div>
<div id="ref-Burton2006-hl" class="csl-entry" role="listitem">
Burton, A., Altman, D. G., Royston, P., &amp; Holder, R. L. (2006). <span class="nocase">The design of simulation studies in medical statistics</span>. <em>Statistics in Medicine</em>, <em>25</em>, 4279–4292. <a href="https://doi.org/10.1002/sim.2673">https://doi.org/10.1002/sim.2673</a>
</div>
<div id="ref-DeCarlo1998-ay" class="csl-entry" role="listitem">
DeCarlo, L. T. (1998). <span class="nocase">Signal detection theory and generalized linear models</span>. <em>Psychological Methods</em>, <em>3</em>, 186–205. <a href="https://doi.org/10.1037/1082-989X.3.2.186">https://doi.org/10.1037/1082-989X.3.2.186</a>
</div>
<div id="ref-DeCarlo2010-lj" class="csl-entry" role="listitem">
DeCarlo, L. T. (2010). <span class="nocase">On the statistical and theoretical basis of signal detection theory and extensions: Unequal variance, random coefficient, and mixture models</span>. <em>Journal of Mathematical Psychology</em>, <em>54</em>, 304–313. <a href="https://doi.org/10.1016/j.jmp.2010.01.001">https://doi.org/10.1016/j.jmp.2010.01.001</a>
</div>
<div id="ref-Dunn1996-yd" class="csl-entry" role="listitem">
Dunn, P. K., &amp; Smyth, G. K. (1996). <span>Randomized Quantile Residuals</span>. <em>Journal of Computational and Graphical Statistics: A Joint Publication of American Statistical Association, Institute of Mathematical Statistics, Interface Foundation of North America</em>, <em>5</em>, 236–244. <a href="https://doi.org/10.1080/10618600.1996.10474708">https://doi.org/10.1080/10618600.1996.10474708</a>
</div>
<div id="ref-Dunn2018-ww" class="csl-entry" role="listitem">
Dunn, P. K., &amp; Smyth, G. K. (2018). <em><span class="nocase">Generalized Linear Models With Examples in R</span></em>. Springer.
</div>
<div id="ref-Gelman2020-tg" class="csl-entry" role="listitem">
Gelman, A., Hill, J., &amp; Vehtari, A. (2020). <em><span class="nocase">Regression and Other Stories</span></em>. Cambridge University Press. <a href="https://doi.org/10.1017/9781139161879">https://doi.org/10.1017/9781139161879</a>
</div>
<div id="ref-Granziol2025-sy" class="csl-entry" role="listitem">
Granziol, U., Rabe, M., Gallucci, M., Spoto, A., &amp; Vidotto, G. (2025). <span class="nocase">Not another post hoc paper: A new look at contrast analysis and planned comparisons</span>. <em>Advances in Methods and Practices in Psychological Science</em>, <em>8</em>. <a href="https://doi.org/10.1177/25152459241293110">https://doi.org/10.1177/25152459241293110</a>
</div>
<div id="ref-Koehler2009-do" class="csl-entry" role="listitem">
Koehler, E., Brown, E., &amp; Haneuse, S. J.-P. A. (2009). <span class="nocase">On the assessment of Monte Carlo error in simulation-based statistical analyses</span>. <em>The American Statistician</em>, <em>63</em>, 155–162. <a href="https://doi.org/10.1198/tast.2009.0030">https://doi.org/10.1198/tast.2009.0030</a>
</div>
<div id="ref-Sanchez-Meca2003-ji" class="csl-entry" role="listitem">
Sánchez-Meca, J., Marín-Martínez, F., &amp; Chacón-Moscoso, S. (2003). <span class="nocase">Effect-size indices for dichotomized outcomes in meta-analysis</span>. <em>Psychological Methods</em>, <em>8</em>, 448–467. <a href="https://doi.org/10.1037/1082-989X.8.4.448">https://doi.org/10.1037/1082-989X.8.4.448</a>
</div>
<div id="ref-Schad2020-ht" class="csl-entry" role="listitem">
Schad, D. J., Vasishth, S., Hohenstein, S., &amp; Kliegl, R. (2020). <span class="nocase">How to capitalize on a priori contrasts in linear (mixed) models: A tutorial</span>. <em>Journal of Memory and Language</em>, <em>110</em>, 104038. <a href="https://doi.org/10.1016/j.jml.2019.104038">https://doi.org/10.1016/j.jml.2019.104038</a>
</div>
<div id="ref-Shimizu2024-xl" class="csl-entry" role="listitem">
Shimizu, Y., Ogawa, K., Kimura, M., Fujiwara, K., &amp; Watanabe, N. (2024). <span class="nocase">The influence of emotional facial expression intensity on decoding accuracy: High intensity does not yield high accuracy</span>. <em>The Japanese Psychological Research</em>, <em>66</em>, 521–540. <a href="https://doi.org/10.1111/jpr.12529">https://doi.org/10.1111/jpr.12529</a>
</div>
<div id="ref-Tjur2009-ml" class="csl-entry" role="listitem">
Tjur, T. (2009). <span class="nocase">Coefficients of Determination in Logistic Regression Models—A New Proposal: The Coefficient of Discrimination</span>. <em>The American Statistician</em>, <em>63</em>, 366–372. <a href="https://doi.org/10.1198/tast.2009.08210">https://doi.org/10.1198/tast.2009.08210</a>
</div>
</div>
</section></section>


    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/psicostat\.github\.io\/glm-workshop\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
                // target, if specified
                link.setAttribute("target", "_blank");
                if (link.getAttribute("rel") === null) {
                  link.setAttribute("rel", "noopener");
                }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    
</body></html>