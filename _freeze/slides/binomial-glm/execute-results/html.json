{
  "hash": "5cd57ab45c698f52de9a2f08c78bec51",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Binomial GLM\nformat:\n    minimal-revealjs: default\n---\n\n\n\n# Binomial distribution\n\n## Binomial distribution\n\n$$\nf(k, n ,p) = \\Pr(X = k) = \\binom{n}{k} p^{k} (1 - p)^{n - k}\n$$\n\nAs introduced before, we are interested in the mean $\\mu$ of the distribution.\n\n$$\n\\mu = np\n$$\n\nThe variance is:\n\n$$\n\\mu = npq = np(1 - p)\n$$\n\n## Binomial distribution, $p$ and *logit*\n\nThe core parameter is $p$, the probability of success. In other terms, we want to include predictors on $p$.\n\n$$\np_i = g^{-1}(\\beta_0 + \\beta_1x_{1i} + \\beta_2x_{2i} + \\dots + \\beta_px_{pi})\n$$\n\nBut what the link function $g(\\cdot)$ actually means? The usual link function is the *logit*. The logit of $p$ is defined as:\n\n$$\n\\mbox{logit}(p) = \\log{\\frac{p}{1 - p}}\n$$\n\n## Odds and probabilities\n\nTo understand the logit, the first element is the odds. Odds are other ways of expressing probabilities.\n\n$$\n\\mbox{odds}(p) = \\frac{p}{1 - p}\n$$\n\nOdds are not usually used in daily life. An exception is the betting context, where the chance of winning is commonly expressed in terms of odds.\n\n> **For example**: saying that the probability of winning is $p = 0.7$ means that the odds of winning are $\\mbox{odds}(p) = 0.7/0.3 = 2.33$\n\n## Odds and probabilities\n\nA more intuitive way is saying that we have *2.33 successes for each failure*.\n\nOdds can be easily reversed. For example, $1 / 2.33 = 0.43$. This means that the odds of losing are 0.42 or that we have 0.42 failures for each success.\n\nOdds are non negative and bounded between 0 and $+\\infty$.\n\n## Odds and probabilities\n\nWe can plot probabilities against odds to show the relationship. The red line is the null value $\\mbox{odds}(0.5) = 1$:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](binomial-glm_files/figure-revealjs/unnamed-chunk-2-1.png){width=960}\n:::\n:::\n\n\n## Odds and probabilities\n\nThe plot is not very clear. Because the odds are non symmetric around the null value. We can try taking the log to stabilize the relationship.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](binomial-glm_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n## Odds and probabilities\n\nTaking the log of an odds is called the logit transformation. This has some nice properties:\n\n- Logit are symmetric around 0\n- The sign tell us who is higher:\n    - A logit of 0 means that $p = 0.5$\n    - A positive logit means that $p > 0.5$ or that $\\mbox{odds}(p) > 1$\n    - A negative logit means that $p < 0.5$ or that $\\mbox{odds}(p) < 1$\n\n## Odds and probabilities\n\nWe can always go back to probabilities. If you start with plain odds:\n\n$$\np = \\frac{\\mbox{odds}(p)}{1 + \\mbox{odds}(p)}\n$$\n\nOr if you have logit:\n\n$$\np = \\frac{e^{\\mbox{logit}(p)}}{1 + e^{\\mbox{logit}(p)}}\n$$\n\n## What about two probabilities?\n\nAssuming to have two probabilities that we want to compare. Like two groups, two conditions, etc. What we can do?\n\nLet's try taking the ratio of two odds. Assuming that group 1 has probability of success of 0.7 and group 2 has 0.4.\n\n$$\n\\mbox{odds}_1 = \\frac{0.7}{0.3} , \\mbox{odds}_2 = \\frac{0.4}{0.6}\n$$\n\n$$\n\\frac{\\mbox{odds}_1}{\\mbox{odds}_2} = \\frac{\\frac{0.7}{0.3}}{\\frac{0.4}{0.6}} = \\frac{2.33}{0.66} = 3.5\n$$\n\nWhat is the meaning?\n\n## What about two probabilities?\n\nThis ratio means that the odds at the numerator (group 1) are ~3.5 times higher that the odds of the denominator (group 2).\n\nWe calculated a very important quantity called **Odds Ratio** (OR). Properties of **Odds Ratio**s are the same as odds. They ranged from 0 to $+\\infty$, the null value is 1, they are asymmetric.\n\nThis means that we can take the log, stabilize the pattern and obtain a symmetric measure around 0.\n\n## What about two probabilities?\n\nThe main point of taking the log is the following:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nor <- function(p1, p2) odds(p1) / odds(p2)\n\n# difference in probabilities = 0.2\nor(0.7, 0.5)\n## [1] 2.333333\nor(0.5, 0.7)\n## [1] 0.4285714\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# taking the log\n\nlog(or(0.7, 0.5))\n## [1] 0.8472979\nlog(or(0.5, 0.7))\n## [1] -0.8472979\n```\n:::\n\n\nA flipped OR is just a sign flip in the log space.\n\n## What about two probabilities?\n\nA flipped OR is just a sign flip in the log space.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlog(or(0.7, 0.5))\n## [1] 0.8472979\nlog(odds(0.7)) - log(odds(0.5))\n## [1] 0.8472979\n# logit(0.7) - logit(0.5)\n```\n:::\n\n\nThis is crucial! A ratio in the probability/odds space is a difference in the logit space.\n\nThis means that when using the logit, ratios are differences as in a standard linear model. \n\n::: {.callout-tip}\nThe log of a numerator/denominator is the difference numerator - denominator.\n:::\n\n## What about two probabilities?\n\nThis point can be better understood with a picture.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](binomial-glm_files/figure-revealjs/unnamed-chunk-7-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "binomial-glm_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}